<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://gambitbsm.org/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://gambitbsm.org/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://gambitbsm.org/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var e=localStorage.getItem("theme");e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://gambitbsm.org/main.f8151591b2672085f0933fc9a990f490d47a5bae835eba13e592ae582ffe5e3a9177998e140a75a274da31357b8222d58a74d4a9f10720e05b02bc2a37e6f0ec.css integrity="sha512-+BUVkbJnIIXwkz/JqZD0kNR6W66DXroT5ZKuWC/+XjqRd5mOFAp1onTaMTV7giLVinTUqfEHIOBbArwqN+bw7A==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>file asciiprinter/asciireader.cpp - GAMBIT</title><meta name=description content="[No description available]"><link rel=canonical href=https://gambitbsm.org/documentation/code/files/asciireader_8cpp/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="file asciiprinter/asciireader.cpp"><meta property="og:description" content="[No description available]"><meta property="og:url" content="https://gambitbsm.org/documentation/code/files/asciireader_8cpp/"><meta property="og:site_name" content="GAMBIT"><meta property="og:image" content="https://gambitbsm.org/gambit_logo.png"><meta property="og:image:alt" content="GAMBIT"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content><meta name=twitter:creator content><meta name=twitter:title content="file asciiprinter/asciireader.cpp"><meta name=twitter:description content="[No description available]"><meta name=twitter:image content="https://gambitbsm.org/gambit_logo.png"><meta name=twitter:image:alt content="file asciiprinter/asciireader.cpp"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://gambitbsm.org/#/schema/organization/1","name":"Doks","url":"https://gambitbsm.org/","sameAs":["https://github.com/GambitBSM"],"logo":{"@type":"ImageObject","@id":"https://gambitbsm.org/#/schema/image/1","url":"https://gambitbsm.org/logo-doks.png","width":450,"height":416,"caption":"Doks"},"image":{"@id":"https://gambitbsm.org/#/schema/image/1"}},{"@type":"WebSite","@id":"https://gambitbsm.org/#/schema/website/1","url":"https://gambitbsm.org/","name":"GAMBIT","description":"Documentation for GAMBIT, the Global And Modular BSM Inference Tool","publisher":{"@id":"https://gambitbsm.org/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://gambitbsm.org/documentation/code/files/asciireader_8cpp/","url":"https://gambitbsm.org/documentation/code/files/asciireader_8cpp/","name":"file asciiprinter\/asciireader.cpp","description":"[No description available]","isPartOf":{"@id":"https://gambitbsm.org/#/schema/website/1"},"about":{"@id":"https://gambitbsm.org/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"https://gambitbsm.org/documentation/code/files/asciireader_8cpp/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://gambitbsm.org/documentation/code/files/asciireader_8cpp/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://gambitbsm.org/documentation/code/files/asciireader_8cpp/"]}]},{"@type":"BreadcrumbList","@id":"https://gambitbsm.org/documentation/code/files/asciireader_8cpp/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://gambitbsm.org/","url":"https://gambitbsm.org/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://gambitbsm.org/documentation/","url":"https://gambitbsm.org/documentation/","name":"Documentation"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://gambitbsm.org/documentation/code/","url":"https://gambitbsm.org/documentation/code/","name":"Code"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"https://gambitbsm.org/documentation/code/files/","url":"https://gambitbsm.org/documentation/code/files/","name":"Files"}},{"@type":"ListItem","position":5,"item":{"@id":"https://gambitbsm.org/documentation/code/files/asciireader_8cpp/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://gambitbsm.org/documentation/code/files/asciireader_8cpp/#/schema/image/2","url":"https://gambitbsm.org/gambit_logo.png","contentUrl":"https://gambitbsm.org/gambit_logo.png","caption":"file asciiprinter\/asciireader.cpp"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://gambitbsm.org/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=https://gambitbsm.org/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=https://gambitbsm.org/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://gambitbsm.org/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://gambitbsm.org/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://gambitbsm.org/site.webmanifest></head><body class="documentation single light"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=https://gambitbsm.org/ aria-label=GAMBIT><img class=logo-light src=https://gambitbsm.org/gambit_logo.png width=50px>
<img class="logo-dark d-none" src=https://gambitbsm.org/gambit_logo.png width=50px>
GAMBIT</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>GAMBIT</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Releases
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.4>GAMBIT 2-4 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.3>GAMBIT 2-3 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.2>GAMBIT 2-2 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.1>GAMBIT 2-1 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.4/tags>All releases ⧉</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Documentation
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/documentation/installation/introduction/>Installation</a></li><li><a class=dropdown-item href=/documentation/tutorials/the_gambit_interface>Tutorials</a></li><li><a class=dropdown-item href=/documentation/help/common_problems_and_questions/>Help</a></li><li><a class=dropdown-item href=/documentation/code/index_classes>Code Reference</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Community
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/community/publications/>Publications</a></li><li><a class=dropdown-item href=/community/talks/>Talks</a></li><li><a class=dropdown-item href=/community/members/>Members</a></li><li><a class=dropdown-item href=/community/code_of_conduct/>Code of Conduct</a></li><li><a class=dropdown-item href=/community/contact/>Contact</a></li></ul></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search site..." aria-label="Search site..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/GambitBSM><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-installation aria-expanded=false>
Installation</button><div class=collapse id=section-installation><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/installation/introduction/>Getting Started</a></li><li><a class="docs-link rounded" href=/documentation/installation/docker_usage/>Docker Usage</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_linux/>Installation for Linux</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_windows/>Installation for Windows</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_macos/>Installation for macOS</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-tutorials aria-expanded=false>
Tutorials</button><div class=collapse id=section-tutorials><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/tutorials/the_gambit_interface/>1 - The GAMBIT Interface</a></li><li><a class="docs-link rounded" href=/documentation/tutorials/in_person_tutorials/>In person tutorials</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-help aria-expanded=false>
Help</button><div class=collapse id=section-help><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/help/common_problems_and_questions/>Common Problems and Questions</a></li><li><a class="docs-link rounded" href=/documentation/help/compiler_matrix/>Compiler Matrix</a></li><li><a class="docs-link rounded" href=/documentation/help/known_issues/>Known Issues</a></li><li><a class="docs-link rounded" href=/documentation/help/configuration_examples/>Configuration Examples</a></li><li><a class="docs-link rounded" href=/documentation/help/support/>Support</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-code aria-expanded=false>
Code Reference</button><div class=collapse id=section-code><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/code/index_classes/>Classes</a></li><li><a class="docs-link rounded" href=/documentation/code/index_files/>Files</a></li><li><a class="docs-link rounded" href=/documentation/code/index_pages/>Pages</a></li><li><a class="docs-link rounded" href=/documentation/code/index_namespaces/>Namespaces</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#namespaces>Namespaces</a></li><li><a href=#detailed-description>Detailed Description</a></li><li><a href=#source-code>Source code</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#namespaces>Namespaces</a></li><li><a href=#detailed-description>Detailed Description</a></li><li><a href=#source-code>Source code</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=/>Home</a></li><li class=breadcrumb-item><a href=/documentation/>Documentation</a></li><li class=breadcrumb-item><a href=/documentation/code/>Code Reference</a></li><li class="breadcrumb-item active" aria-current=page>file asciiprinter/asciireader.cpp</li></ol></nav><p class=lead></p><h1 id=file-asciiprinter-asciireader-cpp>file asciiprinter/asciireader.cpp <a href=#file-asciiprinter-asciireader-cpp class=anchor aria-hidden=true>#</a></h1><p>[No description available] <a href=#detailed-description>More&mldr;</a></p><h2 id=namespaces>Namespaces <a href=#namespaces class=anchor aria-hidden=true>#</a></h2><table><thead><tr><th>Name</th></tr></thead><tbody><tr><td><strong><a href=/documentation/code/namespaces/namespacegambit/>Gambit</a></strong><br>TODO: see if we can use this one:</td></tr><tr><td><strong><a href=/documentation/code/namespaces/namespacegambit_1_1printers/>Gambit::Printers</a></strong><br>Forward declaration.</td></tr></tbody></table><h2 id=detailed-description>Detailed Description <a href=#detailed-description class=anchor aria-hidden=true>#</a></h2><p><strong>Author</strong>: Ben Farmer (<a href=mailto:benjamin.farmer@monash.edu.au>benjamin.farmer@monash.edu.au</a>)</p><p><strong>Date</strong>: 2016 Jan</p><p>Ascii printer retriever class declaration This is a class accompanying the asciiReader which takes care of <em>reading</em> from output created by the asciiReader.</p><hr><p>Authors (add name and date if you modify):</p><hr><h2 id=source-code>Source code <a href=#source-code class=anchor aria-hidden=true>#</a></h2><pre><code>//   GAMBIT: Global and Modular BSM Inference Tool
//   *********************************************
///  \file
///
///  Ascii printer retriever class declaration
///  This is a class accompanying the asciiReader
///  which takes care of *reading* from output
///  created by the asciiReader.
///
///  *********************************************
///
///  Authors (add name and date if you modify):
///
///  \author Ben Farmer
///          (benjamin.farmer@monash.edu.au)
///  \date 2016 Jan
///
///  *********************************************

#include &quot;gambit/Printers/printers/asciireader.hpp&quot;
#include &quot;gambit/Utils/util_functions.hpp&quot;
#include &quot;gambit/Logs/logger.hpp&quot;

namespace Gambit {
  namespace Printers {

    /// Helper function for map lookup
    uint safe_col_lookup(const std::string&amp; key, const std::map&lt;std::string,uint&gt;&amp; colmap, std::string fname)
    {
      auto it = colmap.find(key);
      if(it==colmap.end())
      {
         std::ostringstream err;
         err &lt;&lt; &quot;Error! asciiReader could not locate the required entry '&quot;&lt;&lt;key&lt;&lt;&quot;' in the info file '&quot;&lt;&lt;fname&lt;&lt;&quot;'. Please check that the supplied filename is a valid 'info' file produced by asciiPrinter in a previous scan.&quot; &lt;&lt; std::endl;
         printer_error().raise(LOCAL_INFO,err.str());
      }
      return it-&gt;second;
    }

    /// @{ General members of 'asciiReader'

    /// Constructor
    asciiReader::asciiReader(const Options&amp; options)
      : infoFile_name( options.getValue&lt;std::string&gt;(&quot;info_filename&quot;) )
      , dataFile_name( options.getValue&lt;std::string&gt;(&quot;data_filename&quot;) )
      , column_map( get_column_info(infoFile_name) )
      , col_rank( safe_col_lookup(&quot;MPIrank&quot;, column_map, infoFile_name) )
      , col_ptID( safe_col_lookup(&quot;pointID&quot;, column_map, infoFile_name) )
      , dataset_length(0)
      , current_row(0)
      , current_point(0,0)
      , current_line(&quot;&quot;)
    {
      logger() &lt;&lt; LogTags::info &lt;&lt; &quot;asciiReader: Constructing 'asciiReader' for performing retrieval from previous output. File to be accessed is:&quot;&lt;&lt;std::endl;
      logger() &lt;&lt; &quot;  data file: &quot; &lt;&lt; dataFile_name &lt;&lt; std::endl;
      logger() &lt;&lt; &quot;  info file: &quot; &lt;&lt; infoFile_name &lt;&lt; std::endl;
      logger() &lt;&lt; EOM;

      /// Open output data file
      dataFile.open(dataFile_name);

      if( dataFile.fail() )
      {
        std::ostringstream err;
        err &lt;&lt; &quot;Error! asciiReader failed to open 'data' file '&quot;&lt;&lt;dataFile_name&lt;&lt;&quot;' for reading past scan output. OS message was: &quot;&lt;&lt;strerror(errno);
        printer_error().raise(LOCAL_INFO,err.str());
      }

      /// Scan through file and figure out how many points are in the dataset
      get_next_point();
      dataset_length++;
      if(eoi())
      {
        std::ostringstream err;
        err &lt;&lt; &quot;Error! asciiReader reached end of input file '&quot;&lt;&lt;dataFile_name&lt;&lt;&quot;' immediately (file seems to be empty?). Please check the path specified in the YAML config file for this run.&quot; &lt;&lt; std::endl;
        printer_error().raise(LOCAL_INFO,err.str());
      }

      while(not eoi())
      {
        get_next_point();
        dataset_length++;
      }
      // Note, there is an extra iteration here (one past the end), so the length is indeed the actual length (since we started counting at zero), not the index of the last entry.
      reset();
    }

    /// Get total length of dataset
    ulong asciiReader::get_dataset_length()
    {
      return dataset_length;
    }

    // Get a linear index which corresponds to the current rank/ptID pair in the iterative sense
    ulong asciiReader::get_current_index()
    {
      return current_row;
    }

    /// Reset read head position to zero
    void asciiReader::reset()
    {
      dataFile.close();
      dataFile.open(dataFile_name);

      if( dataFile.fail() )
      {
        std::ostringstream err;
        err &lt;&lt; &quot;Error! asciiReader failed to re-open 'data' file '&quot;&lt;&lt;dataFile_name&lt;&lt;&quot;' for reading previous output while resetting read-head position. OS message was: &quot;&lt;&lt;strerror(errno);
        printer_error().raise(LOCAL_INFO,err.str());
      }

      /// Reset row count
      current_row = 0;
    }

    // Get current rank/ptID pair in data file
    // Make sure get_next_point has been called first! Otherwise we may not have a current point to get
    PPIDpair asciiReader::get_current_point()
    {
      return current_point;
    }

    /// Get next rank/ptID pair
    PPIDpair asciiReader::get_next_point()
    {
      next_row();
      // Point will get returned, but check eoi() before using it! If eoi() then we didn't actually get a new point, this should still just be the previous point.
      return get_current_point();
    }

    /// Check for end of input (or otherwise unreadable state)
    bool asciiReader::asciiReader::eoi()
    {
      //bool tmp = !dataFile;
      //std::cout &lt;&lt; &quot;eoi()? &quot; &lt;&lt; tmp &lt;&lt; std::endl;
      //if(!dataFile) { std::cout &lt;&lt; &quot;At end of file!&quot; &lt;&lt; std::endl; }
      return !dataFile;
    }



    /// Open an 'info' file and figure out what column is what
    std::map&lt;std::string,uint&gt; asciiReader::get_column_info(const std::string&amp; info_filename)
    {
      std::map&lt;std::string,uint&gt; column_map;

      std::ifstream infoFile;
      infoFile.open(info_filename);

      if ( infoFile.fail() )
      {
        std::ostringstream err;
        err &lt;&lt; &quot;Error! asciiReader failed to open 'info' file '&quot;&lt;&lt;info_filename&lt;&lt;&quot;' for reading column metadata. OS message was: &quot;&lt;&lt; strerror(errno);
        printer_error().raise(LOCAL_INFO,err.str());
      }

      /// Get column descriptions
      /// Examples:
      ///Column 3: MPIrank
      ///Column 4: pointID
      ///Column 6: &quot;#NormalDist_parameters @NormalDist::primary_parameters::mu&quot;
      std::string line;
      while(std::getline(infoFile, line)){
         std::string garbage;
         std::string description;
         int col_index;
         std::istringstream iss(line);
         iss &gt;&gt; garbage; // First column is the just the word 'Column'
         iss &gt;&gt; col_index; // Column index (I think the trailing colon will get ignored, so this is ok)
         iss &gt;&gt; garbage; // The colon
         iss &gt;&gt; std::ws; // Consume whitespace
         getline(iss, description); // Put rest of line into the 'description' string.
         column_map[description] = col_index-1; // convert to zero-indexed format
         /// DEBUGGING
         //std::cout &lt;&lt; &quot; From '&quot;&lt;&lt;line&lt;&lt;&quot;' extracted description '&quot;&lt;&lt;description&lt;&lt;&quot;' and index '&quot;&lt;&lt;col_index-1&lt;&lt;&quot;'&quot;&lt;&lt;std::endl;
      }
      infoFile.close();

      return column_map;
    }

    // Advance the read-head by one row
    void asciiReader::next_row()
    {
       if(eoi())
       {
          std::ostringstream err;
          err &lt;&lt; &quot;Error! asciiReader attempted to iterate past the end of the wrapped output file (&quot;&lt;&lt;dataFile_name&lt;&lt;&quot;)! When iterating through output please check for the end-of-iteration via 'eoi()' before calling 'get_next_point()'.&quot;;
          printer_error().raise(LOCAL_INFO,err.str());
       }

       // Get new line data
       std::getline(dataFile, current_line);
       if(!eoi())
       {
         // Process line and find the MPIrank and pointID entries
         std::istringstream iss(current_line);
         unsigned int i=0;
         std::string garbage; // can't use double, some entries might be 'none'
         uint  MPIrank = 0;
         ulong pointID = 0;
         double tmp; // Seem to need to convert to double first due to exponential notation
         bool got_MPIrank(false);
         bool got_pointID(false);

         while(i&lt;=col_rank or i&lt;=col_ptID)
         {
           if     (i==col_rank){ iss &gt;&gt; tmp; MPIrank=(uint)(tmp+0.5); got_MPIrank=true; }
           else if(i==col_ptID){ iss &gt;&gt; tmp; pointID=(ulong)(tmp+0.5); got_pointID=true; }
           else { iss &gt;&gt; garbage; }
           if(!iss)
           {
             std::ostringstream err;
             err &lt;&lt; &quot;Error! asciiReader failed to read line '&quot;&lt;&lt;current_row+1&lt;&lt;&quot;', column '&quot;&lt;&lt;i+1&lt;&lt;&quot;' from the wrapped output file '&quot;&lt;&lt;dataFile_name&lt;&lt;&quot;'! The file may be corrupt.&quot;;
             printer_error().raise(LOCAL_INFO,err.str());
           }
           i++;
         }

         if(not got_MPIrank)
         {
             std::ostringstream err;
             err &lt;&lt; &quot;Error! asciiReader failed to extract the MPIrank from line '&quot;&lt;&lt;current_row+1&lt;&lt;&quot;' of the wrapped output file '&quot;&lt;&lt;dataFile_name&lt;&lt;&quot;'!&quot;;
             printer_error().raise(LOCAL_INFO,err.str());
         }

         if(not got_pointID)
         {
             std::ostringstream err;
             err &lt;&lt; &quot;Error! asciiReader failed to extract the pointID from line '&quot;&lt;&lt;current_row+1&lt;&lt;&quot;' of the wrapped output file '&quot;&lt;&lt;dataFile_name&lt;&lt;&quot;'!&quot;;
             printer_error().raise(LOCAL_INFO,err.str());
         }

         // Set new position data
         current_point = PPIDpair(pointID,MPIrank);
         current_row++;
         // Before trying to access stuff from this row, check for end of file via eoi() function!
       }
       // Else do nothing, but make sure to check eoi() in other functions before trying to do stuff with this row!
    }


    /// Advance the 'read head' position for output retrieval until the requested rank/pointID entry is found
    void asciiReader::advance_to_point(const PPIDpair&amp; target_point)
    {
      // Check if we are at the right place for the point already
      if(current_point!=target_point)
      {
         //std::cout&lt;&lt;&quot;Not at correct point! Move read head until we find it!&quot;&lt;&lt;std::endl;//DEBUG
         //std::cout&lt;&lt;&quot; (&quot;&lt;&lt;current_point.first&lt;&lt;&quot;, &quot;&lt;&lt;current_point.second&lt;&lt;&quot;) ---&gt;  (&quot;&lt;&lt;target_point.first&lt;&lt;&quot;,&quot;&lt;&lt;target_point.second&lt;&lt;&quot;)&quot;&lt;&lt;std::endl;
         // Need to search for the point
         ulong start_pos = current_row; // Record starting position
         bool begun_new_loop(false);  // Flag to check if we have already looped past the end of the file once

         /// Loop until we find the right point
         while(current_point!=target_point)
         {
           next_row();
           if(eoi()) /// If end of file, need to reset the file
           {
             if(begun_new_loop)
             {
               // Already initiated new loop once; don't do it again!
               std::ostringstream err;
               err &lt;&lt; &quot;Error! asciiReader tried to initiate a second loop over output data while searching for a point in '&quot;&lt;&lt;dataFile_name&lt;&lt;&quot;'! This should never happen and indicates a bug in asciiPrinter, please file a bug report.&quot;;
               printer_error().raise(LOCAL_INFO,err.str());
             }

             /// Presumably we have reached the end of the file; so close it and reopen it,
             /// to wrap around and search for the desired point from the beginning.
             reset();

             // Get first row data
             next_row();
             if(eoi()) // If it is still eoi() there is probably nothing in the file...
             {
               std::ostringstream err;
               err &lt;&lt; &quot;Error! asciiReader could not find the requested MPIrank/pointID pair in the searched output data file '&quot;&lt;&lt;dataFile_name&lt;&lt;&quot;'! File appears to be empty or corrupted!&quot;;
               printer_error().raise(LOCAL_INFO,err.str());
             }
           }

           // Check that we haven't been here already!
           if(current_row==start_pos)
           {
              std::ostringstream err;
              err &lt;&lt; &quot;Error! asciiReader could not find the requested MPIrank/pointID pair in the searched output data file '&quot;&lt;&lt;dataFile_name&lt;&lt;&quot;'! Please ensure that this point exists in the data file (e.g. by iterating through the full point list using 'get_next_point()')&quot;;
              printer_error().raise(LOCAL_INFO,err.str());
           }
         }
      }
      //std::cout&lt;&lt;&quot; Advanced to point: (&quot;&lt;&lt;current_point.first&lt;&lt;&quot;, &quot;&lt;&lt;current_point.second&lt;&lt;&quot;)&quot;&lt;&lt;std::endl;
      // Else Already at the right place! No need to do anything.
    } // end function

    /// Get all output column labels
    std::set&lt;std::string&gt; asciiReader::get_all_labels()
    {
       std::set&lt;std::string&gt; out;
       for(auto it = column_map.begin(); it!=column_map.end(); ++it)
       {
         out.insert(it-&gt;first);
       }
       return out;
    }
    /// @}

  }
}
</code></pre><hr><p>Updated on 2023-06-26 at 21:36:54 +0000</p></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://gohugo.io/>Hugo</a> and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/license/>License</a></li></ul></div></div></div></footer><script src=/js/bootstrap.min.a08b5ca912a508bc013bbd939befee438a0d2f798076e860e42147c7c0e2a01cf714847f7f5a2824876ce72867b0182df10e3537711faff352dd1ef41550be7c.js integrity="sha512-oItcqRKlCLwBO72Tm+/uQ4oNL3mAduhg5CFHx8DioBz3FIR/f1ooJIds5yhnsBgt8Q41N3Efr/NS3R70FVC+fA==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.ce91dadbce67e8eef36fa222c1c74c99f623c836cf6a316dffa1aeb390ab659d9a20d8145ceac39e049c555414fc360d31315e7980535dc6c03eb5374b7d559d.js integrity="sha512-zpHa285n6O7zb6IiwcdMmfYjyDbPajFt/6Gus5CrZZ2aINgUXOrDngScVVQU/DYNMTFeeYBTXcbAPrU3S31VnQ==" crossorigin=anonymous defer></script>
<script src=/main.min.57d9a84956f7d60008c47938c7fdd2f75e8618ff1d09c5a5e2b32f91debaf7681f7ceca8b51aded60067c2136172134a91ebc0674487c76a04e3244d927ebdde.js integrity="sha512-V9moSVb31gAIxHk4x/3S916GGP8dCcWl4rMvkd6692gffOyotRre1gBnwhNhchNKkevAZ0SHx2oE4yRNkn693g==" crossorigin=anonymous defer></script>
<script src=https://gambitbsm.org/index.min.ab0cd9f661c586d21963881b48d270dfb3e994411ae17fc96f3d40f51f731e35ac9b5f5442dc7b537d8ad8e72d337a6ecaafa0a29e4d7c37597b0d66a8cb1cab.js integrity="sha512-qwzZ9mHFhtIZY4gbSNJw37PplEEa4X/Jbz1A9R9zHjWsm19UQtx7U32K2OctM3puyq+gop5NfDdZew1mqMscqw==" crossorigin=anonymous defer></script></body></html>