<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://gambitbsm.org/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://gambitbsm.org/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://gambitbsm.org/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var e=localStorage.getItem("theme");e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://gambitbsm.org/main.3c2b4a6cd958642332ded5f775016c68e1cf99ee481e9caaa18332566f89f0a6a2dcccf475ff5c3ac2a4f86dbbf7dac995e825081820218b3ebf1c5b16fc3800.css integrity="sha512-PCtKbNlYZCMy3tX3dQFsaOHPme5IHpyqoYMyVm+J8Kai3Mz0df9cOsKk+G2799rJleglCBggIYs+vxxbFvw4AA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>file src/logging.cpp - GAMBIT</title><meta name=description content="[No description available]"><link rel=canonical href=https://gambitbsm.org/documentation/code/files/logging_8cpp/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="file src/logging.cpp"><meta property="og:description" content="[No description available]"><meta property="og:url" content="https://gambitbsm.org/documentation/code/files/logging_8cpp/"><meta property="og:site_name" content="GAMBIT"><meta property="og:image" content="https://gambitbsm.org/gambit_logo.png"><meta property="og:image:alt" content="GAMBIT"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content><meta name=twitter:creator content><meta name=twitter:title content="file src/logging.cpp"><meta name=twitter:description content="[No description available]"><meta name=twitter:image content="https://gambitbsm.org/gambit_logo.png"><meta name=twitter:image:alt content="file src/logging.cpp"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://gambitbsm.org/#/schema/organization/1","name":"Doks","url":"https://gambitbsm.org/","sameAs":["https://github.com/GambitBSM"],"logo":{"@type":"ImageObject","@id":"https://gambitbsm.org/#/schema/image/1","url":"https://gambitbsm.org/logo-doks.png","width":450,"height":416,"caption":"Doks"},"image":{"@id":"https://gambitbsm.org/#/schema/image/1"}},{"@type":"WebSite","@id":"https://gambitbsm.org/#/schema/website/1","url":"https://gambitbsm.org/","name":"GAMBIT","description":"Documentation for GAMBIT, the Global And Modular BSM Inference Tool","publisher":{"@id":"https://gambitbsm.org/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://gambitbsm.org/documentation/code/files/logging_8cpp/","url":"https://gambitbsm.org/documentation/code/files/logging_8cpp/","name":"file src\/logging.cpp","description":"[No description available]","isPartOf":{"@id":"https://gambitbsm.org/#/schema/website/1"},"about":{"@id":"https://gambitbsm.org/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"https://gambitbsm.org/documentation/code/files/logging_8cpp/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://gambitbsm.org/documentation/code/files/logging_8cpp/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://gambitbsm.org/documentation/code/files/logging_8cpp/"]}]},{"@type":"BreadcrumbList","@id":"https://gambitbsm.org/documentation/code/files/logging_8cpp/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://gambitbsm.org/","url":"https://gambitbsm.org/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://gambitbsm.org/documentation/","url":"https://gambitbsm.org/documentation/","name":"Documentation"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://gambitbsm.org/documentation/code/","url":"https://gambitbsm.org/documentation/code/","name":"Code"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"https://gambitbsm.org/documentation/code/files/","url":"https://gambitbsm.org/documentation/code/files/","name":"Files"}},{"@type":"ListItem","position":5,"item":{"@id":"https://gambitbsm.org/documentation/code/files/logging_8cpp/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://gambitbsm.org/documentation/code/files/logging_8cpp/#/schema/image/2","url":"https://gambitbsm.org/gambit_logo.png","contentUrl":"https://gambitbsm.org/gambit_logo.png","caption":"file src\/logging.cpp"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://gambitbsm.org/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=https://gambitbsm.org/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=https://gambitbsm.org/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://gambitbsm.org/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://gambitbsm.org/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://gambitbsm.org/site.webmanifest></head><body class="documentation single light"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=https://gambitbsm.org/ aria-label=GAMBIT><img class=logo-light src=https://gambitbsm.org/gambit_logo.png width=50px>
<img class="logo-dark d-none" src=https://gambitbsm.org/gambit_logo.png width=50px>
GAMBIT</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>GAMBIT</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Releases
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.4>GAMBIT 2-4 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.3>GAMBIT 2-3 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.2>GAMBIT 2-2 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.1>GAMBIT 2-1 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.4/tags>All releases ⧉</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Documentation
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/documentation/installation/introduction/>Installation</a></li><li><a class=dropdown-item href=/documentation/tutorials/the_gambit_interface>Tutorials</a></li><li><a class=dropdown-item href=/documentation/help/common_problems_and_questions/>Help</a></li><li><a class=dropdown-item href=/documentation/code/index_classes>Code Reference</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Community
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/community/publications/>Publications</a></li><li><a class=dropdown-item href=/community/talks/>Talks</a></li><li><a class="dropdown-item active" href=/community/members/ aria-current=true>Members</a></li><li><a class=dropdown-item href=/community/code_of_conduct/>Code of Conduct</a></li><li><a class=dropdown-item href=/community/contact/>Contact</a></li></ul></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search site..." aria-label="Search site..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/GambitBSM><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-installation aria-expanded=false>
Installation</button><div class=collapse id=section-installation><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/installation/introduction/>Getting Started</a></li><li><a class="docs-link rounded" href=/documentation/installation/docker_usage/>Docker Usage</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_linux/>Installation for Linux</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_windows/>Installation for Windows</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_macos/>Installation for macOS</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-tutorials aria-expanded=false>
Tutorials</button><div class=collapse id=section-tutorials><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/tutorials/the_gambit_interface/>1 - The GAMBIT Interface</a></li><li><a class="docs-link rounded" href=/documentation/tutorials/in_person_tutorials/>In person tutorials</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-help aria-expanded=false>
Help</button><div class=collapse id=section-help><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/help/common_problems_and_questions/>Common Problems and Questions</a></li><li><a class="docs-link rounded" href=/documentation/help/compiler_matrix/>Compiler Matrix</a></li><li><a class="docs-link rounded" href=/documentation/help/known_issues/>Known Issues</a></li><li><a class="docs-link rounded" href=/documentation/help/configuration_examples/>Configuration Examples</a></li><li><a class="docs-link rounded" href=/documentation/help/support/>Support</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-code aria-expanded=false>
Code Reference</button><div class=collapse id=section-code><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/code/index_classes/>Classes</a></li><li><a class="docs-link rounded" href=/documentation/code/index_files/>Files</a></li><li><a class="docs-link rounded" href=/documentation/code/index_pages/>Pages</a></li><li><a class="docs-link rounded" href=/documentation/code/index_namespaces/>Namespaces</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#namespaces>Namespaces</a></li><li><a href=#detailed-description>Detailed Description</a></li><li><a href=#source-code>Source code</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#namespaces>Namespaces</a></li><li><a href=#detailed-description>Detailed Description</a></li><li><a href=#source-code>Source code</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=/>Home</a></li><li class=breadcrumb-item><a href=/documentation/>Documentation</a></li><li class=breadcrumb-item><a href=/documentation/code/>Code Reference</a></li><li class="breadcrumb-item active" aria-current=page>file src/logging.cpp</li></ol></nav><p class=lead></p><h1 id=file-src-logging-cpp>file src/logging.cpp <a href=#file-src-logging-cpp class=anchor aria-hidden=true>#</a></h1><p>[No description available] <a href=#detailed-description>More&mldr;</a></p><h2 id=namespaces>Namespaces <a href=#namespaces class=anchor aria-hidden=true>#</a></h2><table><thead><tr><th>Name</th></tr></thead><tbody><tr><td><strong><a href=/documentation/code/namespaces/namespacegambit/>Gambit</a></strong><br>TODO: see if we can use this one:</td></tr><tr><td><strong><a href=/documentation/code/namespaces/namespacegambit_1_1logging/>Gambit::Logging</a></strong><br>Forward declare minimial logging components needed to use logger.</td></tr></tbody></table><h2 id=detailed-description>Detailed Description <a href=#detailed-description class=anchor aria-hidden=true>#</a></h2><p><strong>Author</strong>:</p><ul><li>Ben Farmer (<a href=mailto:benjamin.farmer@monash.edu.au>benjamin.farmer@monash.edu.au</a>)</li><li>Pat Scott (<a href=mailto:patscott@physics.mcgill.ca>patscott@physics.mcgill.ca</a>)</li></ul><p><strong>Date</strong>:</p><ul><li>2014 Mar</li><li>2014 Mar, May 2016 Aug</li></ul><p>Member functions of logging classes</p><hr><p>Authors (add name and date if you modify):</p><hr><h2 id=source-code>Source code <a href=#source-code class=anchor aria-hidden=true>#</a></h2><pre><code>//   GAMBIT: Global and Modular BSM Inference Tool
//   *********************************************
///  \file
///
///  Member functions of logging classes
///
///  *********************************************
///
///  Authors (add name and date if you modify):
///
///  \author Ben Farmer
///          (benjamin.farmer@monash.edu.au)
///  \date 2014 Mar
///
///  \author Pat Scott
///          (patscott@physics.mcgill.ca)
///  \date 2014 Mar, May
///        2016 Aug
///
///  *********************************************


// Standard libraries
#include &lt;set&gt;
#include &lt;fstream&gt;
#include &lt;cstdarg&gt;
#include &lt;stdexcept&gt;
#include &lt;algorithm&gt;
#include &lt;limits&gt;
#include &lt;chrono&gt;
#include &lt;omp.h&gt;

// Gambit
#include &quot;gambit/Logs/logger.hpp&quot;
#include &quot;gambit/Logs/logmaster.hpp&quot;
#include &quot;gambit/Logs/logging.hpp&quot;
#include &quot;gambit/Utils/signal_helpers.hpp&quot;
#include &quot;gambit/Utils/util_functions.hpp&quot;
#include &quot;gambit/Utils/standalone_error_handlers.hpp&quot;
#include &quot;gambit/Utils/mpiwrapper.hpp&quot;
#include &quot;gambit/cmake/cmake_variables.hpp&quot;

// Code!
namespace Gambit
{

  namespace Logging
  {

    using namespace LogTags;

    const bool verbose = false;

    // If you add to the following message tags, make sure to update the enum in log_tags.hpp that tracks the number of them!

    // Function to retrieve the 'msgtypes' set of tags
    const std::set&lt;LogTag&gt;&amp; msgtypes()
    {
      static LogTag msg_a[] = {debug, info, warn, err};
      static const std::set&lt;LogTag&gt; msgtypes_set(msg_a, msg_a+sizeof(msg_a)/sizeof(msg_a[0]));
      return msgtypes_set;
    }

    // Function to retrieve the 'flags' set of tags
    const std::set&lt;LogTag&gt;&amp; flags()
    {
      static LogTag flags_a[] = {fatal, nonfatal};
      static const std::set&lt;LogTag&gt; flags_set(flags_a, flags_a+sizeof(flags_a)/sizeof(flags_a[0]));
      return flags_set;
    }

    // Function to retrieve the 'echoes' set of tags
    const std::set&lt;LogTag&gt;&amp; echoes()
    {
      static LogTag echoes_a[] = {repeat_to_cout, repeat_to_cerr};
      static const std::set&lt;LogTag&gt; echoes_set(echoes_a, echoes_a+sizeof(echoes_a)/sizeof(echoes_a[0]));
      return echoes_set;
    }

    // Function to retrieve the 'components' set of tags (needed by module and backend macros so they can add to it)
    std::set&lt;int&gt;&amp; components()
    {
      // We add the core components here, but the module and backend numbers are added later, so the set cannot be const.
      static LogTag core_a[] = {def, core, logs, models, dependency_resolver, scanner, inifile, printers, utils, backends};
      static std::set&lt;int&gt; components_set(core_a, core_a+sizeof(core_a)/sizeof(core_a[0]));
      return components_set;
    }

    // String names for enums
    static std::map&lt;int,std::string&gt; create_tag_names()
    {
       std::map&lt;int,std::string&gt; m;
       m[debug]   = &quot;Debug&quot;;
       m[info]    = &quot;Info&quot;;
       m[warn]    = &quot;Warning&quot;;
       m[err]     = &quot;Error&quot;;
       /* Flags */
       m[fatal]   = &quot;Fatal&quot;;
       m[nonfatal]= &quot;Non-fatal&quot;;
       /* Repeaters */
       m[repeat_to_cout]   = &quot;Echo &gt; stout&quot;;
       m[repeat_to_cerr]= &quot;Echo &gt; sterr&quot;;
       /* Component tags */
       m[def]     = &quot;Default&quot;;
       m[core]    = &quot;Core&quot;;
       m[logs] = &quot;Logger&quot;;
       m[models]  = &quot;Models&quot;;
       m[dependency_resolver]  = &quot;Dependency Resolver&quot;;
       m[scanner]    = &quot;Scanner&quot;;
       m[inifile] = &quot;IniFile&quot;;
       m[printers]= &quot;Printers&quot;;
       m[utils]   = &quot;Utilities&quot;;
       m[backends]= &quot;Backends&quot;;

       // Test numbers:
       if (verbose)
       {
         std::cout&lt;&lt;&quot;Checking LogTag numbers...&quot;&lt;&lt;std::endl;
         for(std::map&lt;int,std::string&gt;::iterator tag = m.begin(); tag != m.end(); ++tag)
         {
           std::cout&lt;&lt;&quot;  &quot;&lt;&lt;tag-&gt;first&lt;&lt;&quot; : &quot;&lt;&lt;tag-&gt;second&lt;&lt;std::endl;
         }
       }

       return m;
    }

    // Function to retrieve the 'tag2str' map outside of this compilation unit
    // (needed by module and backend macros so they can add to it)
    std::map&lt;int,std::string&gt;&amp; tag2str()
    {
      // Can't be const because we will add to it from the module/backend macros
      static std::map&lt;int,std::string&gt; tag2str_map = create_tag_names();
      return tag2str_map;
    }

    // Function to return the next unused tag index
    int getfreetag()
    {
      for(int i=0; i&lt;std::numeric_limits&lt;int&gt;::max(); ++i)
      {
        if( tag2str().count(i) == 0 ) { return i; }
      }
      // Uh oh, seems like we ran out of integers. If this happens you are screwed, and we have to rewrite the code to use long ints instead, or you have to unhook some modules.
      // Cannot log this because we are outside the LogMaster class code.
      std::ostringstream ss;
      ss &lt;&lt; &quot;Error in logger.cpp! It seems that you have so many logging tags that you have exceeded the maximum allowed integer. There is no way you can fix this except to have fewer modules hooked up to gambit all at once. Otherwise we have to rewrite the logger to work with long ints or some such&quot; &lt;&lt; std::endl;
      throw std::overflow_error( ss.str() );
    }

    // Function to do the reverse search (brute force)
    int str2tag(const std::string&amp; tagname)
    {
       for(std::map&lt;int,std::string&gt;::iterator tag = tag2str().begin(); tag != tag2str().end(); ++tag)
       {
         if (tag-&gt;second == tagname) { return tag-&gt;first; }
       }
       // Uh oh, no match found. Return fail code and let caller deal with it
       return -1;
    }

    /// Function to inspect tags and their associated strings. For testing purposes only
    void checktags()
    {
       std::cout&lt;&lt;&quot;Checking message type LogTags...&quot;&lt;&lt;std::endl;
       for(std::set&lt;LogTag&gt;::iterator tag = msgtypes().begin(); tag != msgtypes().end(); ++tag)
       {
         std::cout&lt;&lt;&quot;  &quot;&lt;&lt;*tag&lt;&lt;&quot; : &quot;&lt;&lt;tag2str()[*tag]&lt;&lt;std::endl;
       }
       std::cout&lt;&lt;&quot;Checking message flag LogTags...&quot;&lt;&lt;std::endl;
       for(std::set&lt;LogTag&gt;::iterator tag = flags().begin(); tag != flags().end(); ++tag)
       {
         std::cout&lt;&lt;&quot;  &quot;&lt;&lt;*tag&lt;&lt;&quot; : &quot;&lt;&lt;tag2str()[*tag]&lt;&lt;std::endl;
       }
       std::cout&lt;&lt;&quot;Checking message echo LogTags...&quot;&lt;&lt;std::endl;
       for(std::set&lt;LogTag&gt;::iterator tag = echoes().begin(); tag != echoes().end(); ++tag)
       {
         std::cout&lt;&lt;&quot;  &quot;&lt;&lt;*tag&lt;&lt;&quot; : &quot;&lt;&lt;tag2str()[*tag]&lt;&lt;std::endl;
       }
       std::cout&lt;&lt;&quot;Checking Gambit component LogTags...&quot;&lt;&lt;std::endl;
       for(std::set&lt;int&gt;::iterator tag = components().begin(); tag != components().end(); ++tag)
       {
         std::cout&lt;&lt;&quot;  &quot;&lt;&lt;*tag&lt;&lt;&quot; : &quot;&lt;&lt;tag2str()[*tag]&lt;&lt;std::endl;
       }
       std::cout&lt;&lt;&quot;LogTag check finished.&quot;&lt;&lt;std::endl;
    }


    /// Constructor for SortedMessage struct
    SortedMessage::SortedMessage(const Message&amp; mail)
      : message(mail.message), received_at(mail.received_at)
    {
       // First task is to scan through the tags and figure out where the message is supposed to go
       //std::cout&lt;&lt;&quot;Sorting tags...&quot;&lt;&lt;std::endl;
       for(std::set&lt;int&gt;::iterator tag = mail.tags.begin(); tag != mail.tags.end(); ++tag)
       {
         // Debugging crap... to be deleted.
         // std::cout&lt;&lt;&quot;Sorting tag &quot;&lt;&lt;tag2str()[*tag]&lt;&lt;std::endl;
         // std::cout&lt;&lt;&quot;empty?&quot;&lt;&lt;components().empty()&lt;&lt;std::endl;
         // for(std::set&lt;int&gt;::iterator tag2 = components().begin(); tag2 != components().end(); ++tag2)
         // {
         //    std::cout&lt;&lt;&quot;componentI: &quot;&lt;&lt;*tag2&lt;&lt;std::endl;
         //    std::cout&lt;&lt;&quot;component:  &quot;&lt;&lt;tag2str()[*tag2]&lt;&lt;std::endl;
         // }
         // for(std::set&lt;LogTag&gt;::iterator tag3 = msgtypes().begin(); tag3 != msgtypes().end(); ++tag3)
         // {
         //    std::cout&lt;&lt;&quot;msgtypeI: &quot;&lt;&lt;*tag3&lt;&lt;std::endl;
         //    std::cout&lt;&lt;&quot;msgtype:  &quot;&lt;&lt;tag2str()[*tag3]&lt;&lt;std::endl;
         // }
         // std::cout&lt;&lt;&quot;core:&quot;&lt;&lt;*(components().find(core))&lt;&lt;std::endl;
         // std::cout&lt;&lt;&quot;t1 &quot;&lt;&lt;*(components().find(*tag))&lt;&lt;std::endl;
         // std::cout&lt;&lt;&quot;t2 &quot;&lt;&lt;*(components().end())&lt;&lt;std::endl;
         // std::cout&lt;&lt;&quot;tag &quot;&lt;&lt;*tag&lt;&lt;std::endl;
         // std::cout&lt;&lt;&quot;tag &quot;&lt;&lt;static_cast&lt;LogTag&gt;(*tag)&lt;&lt;std::endl;
         // std::cout&lt;&lt;&quot;mt1 &quot;&lt;&lt;*(msgtypes().find(static_cast&lt;LogTag&gt;(*tag)))&lt;&lt;std::endl;
         // std::cout&lt;&lt;&quot;mt2 &quot;&lt;&lt;*(msgtypes().end())&lt;&lt;std::endl;
         if ( msgtypes().find(static_cast&lt;LogTag&gt;(*tag)) != msgtypes().end() )
         {
           // If tag is a message type, add it to the type_tags set
           //std::cout&lt;&lt;&quot;Identified tag '&quot;&lt;&lt;tag2str()[*tag]&lt;&lt;&quot;' as message type&quot;&lt;&lt;std::endl;
           type_tags.insert(static_cast&lt;LogTag&gt;(*tag));
         }
         else if ( components().find(*tag) != components().end() )
         {
           // std::cout&lt;&lt;&quot;Adding tag &quot;&lt;&lt;tag2str()[*tag]&lt;&lt;std::endl;
           // If tag names a gambit core component, add it to the component_tags set
           //std::cout&lt;&lt;&quot;Identified tag '&quot;&lt;&lt;tag2str()[*tag]&lt;&lt;&quot;' as Gambit component&quot;&lt;&lt;std::endl;
           component_tags.insert(*tag);
         }
         else if ( flags().find(static_cast&lt;LogTag&gt;(*tag)) != flags().end() )
         {
           // If tag is an auxiliary message flag, add it to the flag_tags set
           //std::cout&lt;&lt;&quot;Identified tag '&quot;&lt;&lt;tag2str()[*tag]&lt;&lt;&quot;' as message flag&quot;&lt;&lt;std::endl;
           flag_tags.insert(static_cast&lt;LogTag&gt;(*tag));
         }
         else if ( echoes().find(static_cast&lt;LogTag&gt;(*tag)) != echoes().end() )
         {
           // If tag is a message echo flag, add it to the echo_tags set
           //std::cout&lt;&lt;&quot;Identified tag '&quot;&lt;&lt;tag2str()[*tag]&lt;&lt;&quot;' as message echo flag&quot;&lt;&lt;std::endl;
           echo_tags.insert(static_cast&lt;LogTag&gt;(*tag));
         }
         else
         {
           // If tag was not in of those categories, it shouldn't have been a valid LogTag, and so there should have been a compiler error before now. Since there wasn't, there is something wrong with the LogTag definitions, the tag categories, or this function.
           // TODO: Gambit error! Really bad one that can't be logged.
           // I think we are converging on the idea that this type of error should just throw an ordinary exception.
           std::ostringstream ss;
           ss &lt;&lt; &quot;Error in SortedMessage constructor! One of the tags received could not be found in any of the const LogTag sets. This is supposed to be impossible. Please check that all tags in the LogTags enum (in logger.hpp) are also listed in one (and only one) of the (const) category sets (also in logger.hpp). If this seems fine the problem may be in the code which generates the integer codes for the modules and backends (not yet written...). Tag was number: &quot;&lt;&lt; *tag&lt;&lt;&quot;; name: &quot;&lt;&lt; tag2str()[*tag];
           throw std::logic_error( ss.str() );
         }
       } //end tag sorting
    } // end SortedMessage constructor

    /// %%%% Logger classes %%%

    // Apparantly this cannot be virtual, so provide an implementation for it
    BaseLogger::~BaseLogger() {}

    /// &quot;Standard&quot; logger class

    /// Constructor
    /// Attach logger object to an existing stream
    StdLogger::StdLogger(std::ostream&amp; logstream) 
      : my_stream(logstream)
      , MPIrank(0)
      , MPIsize(1)
    {
      #ifdef WITH_MPI
      if(GMPI::Is_initialized())
      {
        GMPI::Comm COMM_WORLD;
        MPIsize = COMM_WORLD.Get_size();
        MPIrank = COMM_WORLD.Get_rank();
      }
      #endif
      // Check error bits on stream and throw exception in anything is bad
      if( my_stream.fail() || my_stream.bad() )
      {
        std::ostringstream ss;
        ss &lt;&lt; &quot;IO error while constructing StdLogger! Error bit on in supplied ostream.&quot;;
        throw std::runtime_error( ss.str() );
      }
    }

    /// Open new file stream and manage it internally
    StdLogger::StdLogger(const std::string&amp; filename)
      : my_own_fstream(filename, std::ofstream::out)
      , my_stream(my_own_fstream)
      , MPIrank(0)
      , MPIsize(1)
    {
      #ifdef WITH_MPI
      if(GMPI::Is_initialized() &amp;&amp; !GMPI::Is_finalized())
      {
        GMPI::Comm COMM_WORLD;
        MPIsize = COMM_WORLD.Get_size();
        MPIrank = COMM_WORLD.Get_rank();
      }
      #endif
      // Check error bits on stream and throw exception in anything is bad
      if( my_stream.fail() || my_stream.bad() )
      {
         std::ostringstream ss;
         #ifdef WITH_MPI
         ss &lt;&lt; &quot;rank &quot;&lt;&lt;MPIrank&lt;&lt;&quot;: &quot;;
         #endif
         ss &lt;&lt; &quot;IO error while constructing StdLogger! Tried to open ofstream to file \&quot;&quot;&lt;&lt;filename&lt;&lt;&quot;\&quot;, but encountered error bit in the created ostream.&quot;;
         throw std::runtime_error( ss.str() );
      }
    }

    StdLogger::~StdLogger() {}

    /// Write message to log file
    void StdLogger::write(const SortedMessage&amp; mail)
    {
      // Message reception time (UTC)
      my_stream&lt;&lt;&quot;(&quot;&lt;&lt;Utils::return_time_and_date(mail.received_at)&lt;&lt;&quot;)&quot;;
      // Seconds elapsed since start_time
      std::chrono::duration&lt;double&gt; diff = mail.received_at - start_time;
      my_stream&lt;&lt;&quot;(&quot;&lt;&lt;diff.count()&lt;&lt;&quot; [s])&quot;;
      // MPI rank
      // Might as well add this even if different ranks output to different
      // files, since people might like to cat together the different files
      // later on or something.
      if(MPIsize&gt;1) my_stream &lt;&lt; &quot;(Rank &quot; &lt;&lt; MPIrank &lt;&lt; &quot;)&quot;;

      // Message tags
      writetags(mail.component_tags);
      writetags(mail.type_tags);
      writetags(mail.flag_tags);
      my_stream&lt;&lt;&quot;:&quot;&lt;&lt;std::endl;
      // Message proper
      my_stream&lt;&lt;mail.message&lt;&lt;std::endl;
      my_stream&lt;&lt;&quot;--&lt;&gt;--&lt;&gt;--&lt;&gt;--&lt;&gt;--&lt;&gt;--&lt;&gt;--&lt;&gt;--&quot;&lt;&lt;std::endl;
      // (I picked a weird end of message boundary so that it would be easily distinguished from formatting that may appear in the message body)
    }

    void StdLogger::writetags(const std::set&lt;LogTag&gt;&amp; tags)
    {
      // If we can figure out how to cast set&lt;LogTag&gt; to set&lt;int&gt; then we can do this better
      std::set&lt;int&gt; int_tags;
      for(std::set&lt;LogTag&gt;::iterator tag = tags.begin(); tag != tags.end(); ++tag)
      {
        int_tags.insert(*tag); //static_cast&lt;int&gt;(*tag);
      }
      writetags(int_tags);
    }

    void StdLogger::writetags(const std::set&lt;int&gt;&amp; tags)
    {
      std::set&lt;int&gt;::iterator it;

      if( not tags.empty() )
      {
        my_stream&lt;&lt;&quot;[&quot;;
        bool firstloop = true;
        for (it = tags.begin(); it != tags.end(); ++it)
        {
          if (not firstloop) { my_stream&lt;&lt;&quot;,&quot;; }
          //std::cout&lt;&lt;&quot;test: &quot;&lt;&lt;*it&lt;&lt;std::endl;
          //std::cout&lt;&lt;&quot;test2:&quot;&lt;&lt;tag2str().at(*it)&lt;&lt;std::endl;
          my_stream &lt;&lt; tag2str().at(*it); // replace with a lookup of the correct string
          firstloop = false;
        }
        my_stream&lt;&lt;&quot;]&quot;;
      }
    }

    /// Flush stream buffer
    // Possibly unnecessary...
    void StdLogger::flush()
    {
      my_stream.flush();
    }

    /// Destructor
    /// Ensure cached messages are dumped
    // (do we need a cache? linux filesystem probably does this for us...)
    // ~StdLogger::StdLogger()


  } //end namespace Logging
} // end namespace Gambit
</code></pre><hr><p>Updated on 2023-06-26 at 21:36:54 +0000</p></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://gohugo.io/>Hugo</a> and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/license/>License</a></li></ul></div></div></div></footer><script src=/js/bootstrap.min.bae339a7e6ab56cb293de0d32ca82f329cc907de6c7fee03535db82a4d535ba00860468d6a000dda40976e866c5aa8b9cedd7c80d8af148c07a6fbf48319a1b3.js integrity="sha512-uuM5p+arVsspPeDTLKgvMpzJB95sf+4DU124Kk1TW6AIYEaNagAN2kCXboZsWqi5zt18gNivFIwHpvv0gxmhsw==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.9b57a71199a5631d993a12fbdc82447b4a7b08f0e038ea0cd571039981f84192fe2489173f51bc6f1b7079bbcdacb8c94aaa363a4b603101dd42073c91f8403b.js integrity="sha512-m1enEZmlYx2ZOhL73IJEe0p7CPDgOOoM1XEDmYH4QZL+JIkXP1G8bxtwebvNrLjJSqo2OktgMQHdQgc8kfhAOw==" crossorigin=anonymous defer></script>
<script src=/main.min.57d9a84956f7d60008c47938c7fdd2f75e8618ff1d09c5a5e2b32f91debaf7681f7ceca8b51aded60067c2136172134a91ebc0674487c76a04e3244d927ebdde.js integrity="sha512-V9moSVb31gAIxHk4x/3S916GGP8dCcWl4rMvkd6692gffOyotRre1gBnwhNhchNKkevAZ0SHx2oE4yRNkn693g==" crossorigin=anonymous defer></script>
<script src=https://gambitbsm.org/index.min.acd9b2c47d09ad9a62721d04b432dc056a7671d492eb7ccf2d23b5429e7c8180b0a63f602b7c2daf09b9f40bb1ab3a5bdf172c8d945f93ad08bd13b641fe562a.js integrity="sha512-rNmyxH0JrZpich0EtDLcBWp2cdSS63zPLSO1Qp58gYCwpj9gK3wtrwm59Auxqzpb3xcsjZRfk60IvRO2Qf5WKg==" crossorigin=anonymous defer></script></body></html>