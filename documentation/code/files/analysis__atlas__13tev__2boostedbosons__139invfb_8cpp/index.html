<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://gambitbsm.org/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://gambitbsm.org/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://gambitbsm.org/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var e=localStorage.getItem("theme");e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://gambitbsm.org/main.e0ef67572fa591316dbb2b276e1aed52fd04025355d700a37b20ae76eb126fadbe7ceaddbb47632a2f1bf66c490a69e0cd1f1a0dc12b2980ae4b5ffc6d257d62.css integrity="sha512-4O9nVy+lkTFtuysnbhrtUv0EAlNV1wCjeyCudusSb62+fOrdu0djKi8b9mxJCmngzR8aDcErKYCuS1/8bSV9Yg==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>file analyses/Analysis_ATLAS_13TeV_2BoostedBosons_139invfb.cpp - GAMBIT</title><meta name=description content="[No description available]"><link rel=canonical href=https://gambitbsm.org/documentation/code/files/analysis__atlas__13tev__2boostedbosons__139invfb_8cpp/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="file analyses/Analysis_ATLAS_13TeV_2BoostedBosons_139invfb.cpp"><meta property="og:description" content="[No description available]"><meta property="og:url" content="https://gambitbsm.org/documentation/code/files/analysis__atlas__13tev__2boostedbosons__139invfb_8cpp/"><meta property="og:site_name" content="GAMBIT"><meta property="og:image" content="https://gambitbsm.org/gambit_logo.png"><meta property="og:image:alt" content="GAMBIT"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content><meta name=twitter:creator content><meta name=twitter:title content="file analyses/Analysis_ATLAS_13TeV_2BoostedBosons_139invfb.cpp"><meta name=twitter:description content="[No description available]"><meta name=twitter:image content="https://gambitbsm.org/gambit_logo.png"><meta name=twitter:image:alt content="file analyses/Analysis_ATLAS_13TeV_2BoostedBosons_139invfb.cpp"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://gambitbsm.org/#/schema/organization/1","name":"Doks","url":"https://gambitbsm.org/","sameAs":["https://github.com/GambitBSM"],"logo":{"@type":"ImageObject","@id":"https://gambitbsm.org/#/schema/image/1","url":"https://gambitbsm.org/logo-doks.png","width":450,"height":416,"caption":"Doks"},"image":{"@id":"https://gambitbsm.org/#/schema/image/1"}},{"@type":"WebSite","@id":"https://gambitbsm.org/#/schema/website/1","url":"https://gambitbsm.org/","name":"GAMBIT","description":"Documentation for GAMBIT, the Global And Modular BSM Inference Tool","publisher":{"@id":"https://gambitbsm.org/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://gambitbsm.org/documentation/code/files/analysis__atlas__13tev__2boostedbosons__139invfb_8cpp/","url":"https://gambitbsm.org/documentation/code/files/analysis__atlas__13tev__2boostedbosons__139invfb_8cpp/","name":"file analyses\/Analysis_ATLAS_13TeV_2BoostedBosons_139invfb.cpp","description":"[No description available]","isPartOf":{"@id":"https://gambitbsm.org/#/schema/website/1"},"about":{"@id":"https://gambitbsm.org/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"https://gambitbsm.org/documentation/code/files/analysis__atlas__13tev__2boostedbosons__139invfb_8cpp/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://gambitbsm.org/documentation/code/files/analysis__atlas__13tev__2boostedbosons__139invfb_8cpp/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://gambitbsm.org/documentation/code/files/analysis__atlas__13tev__2boostedbosons__139invfb_8cpp/"]}]},{"@type":"BreadcrumbList","@id":"https://gambitbsm.org/documentation/code/files/analysis__atlas__13tev__2boostedbosons__139invfb_8cpp/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://gambitbsm.org/","url":"https://gambitbsm.org/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://gambitbsm.org/documentation/","url":"https://gambitbsm.org/documentation/","name":"Documentation"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://gambitbsm.org/documentation/code/","url":"https://gambitbsm.org/documentation/code/","name":"Code"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"https://gambitbsm.org/documentation/code/files/","url":"https://gambitbsm.org/documentation/code/files/","name":"Files"}},{"@type":"ListItem","position":5,"item":{"@id":"https://gambitbsm.org/documentation/code/files/analysis__atlas__13tev__2boostedbosons__139invfb_8cpp/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://gambitbsm.org/documentation/code/files/analysis__atlas__13tev__2boostedbosons__139invfb_8cpp/#/schema/image/2","url":"https://gambitbsm.org/gambit_logo.png","contentUrl":"https://gambitbsm.org/gambit_logo.png","caption":"file analyses\/Analysis_ATLAS_13TeV_2BoostedBosons_139invfb.cpp"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://gambitbsm.org/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=https://gambitbsm.org/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=https://gambitbsm.org/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://gambitbsm.org/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://gambitbsm.org/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://gambitbsm.org/site.webmanifest></head><body class="documentation single light"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=https://gambitbsm.org/ aria-label=GAMBIT><img class=logo-light src=https://gambitbsm.org/gambit_logo.png width=50px>
<img class="logo-dark d-none" src=https://gambitbsm.org/gambit_logo.png width=50px>
GAMBIT</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>GAMBIT</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Releases
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.6>GAMBIT 2-6 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.5>GAMBIT 2-5 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.4>GAMBIT 2-4 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.3>GAMBIT 2-3 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.2>GAMBIT 2-2 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.1>GAMBIT 2-1 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_light_1.0>GAMBIT Light ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.6/tags>All releases ⧉</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Documentation
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/documentation/installation/introduction/>Installation</a></li><li><a class=dropdown-item href=/documentation/physics/analyses>Physics</a></li><li><a class=dropdown-item href=/documentation/tutorials/the_gambit_interface>Tutorials</a></li><li><a class=dropdown-item href=/documentation/help/common_problems_and_questions/>Help</a></li><li><a class=dropdown-item href=/documentation/code/index_classes>Code Reference</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Community
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=https://github.com/GambitBSM/wiki>Wiki</a></li><li><a class=dropdown-item href=/community/publications/>Publications</a></li><li><a class=dropdown-item href=/community/talks/>Talks</a></li><li><a class=dropdown-item href=/community/members/>Members</a></li><li><a class=dropdown-item href=/community/code_of_conduct/>Code of Conduct</a></li><li><a class="dropdown-item active" href=/community/contact/ aria-current=true>Contact</a></li></ul></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search site..." aria-label="Search site..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/GambitBSM><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-installation aria-expanded=false>
Installation</button><div class=collapse id=section-installation><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/installation/introduction/>Getting Started</a></li><li><a class="docs-link rounded" href=/documentation/installation/docker_usage/>Docker Usage</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_linux/>Installation for Linux</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_windows/>Installation for Windows</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_macos/>Installation for macOS</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-tutorials aria-expanded=false>
Tutorials</button><div class=collapse id=section-tutorials><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/tutorials/the_gambit_interface/>1 - The GAMBIT Interface</a></li><li><a class="docs-link rounded" href=/documentation/tutorials/in_person_tutorials/>In person tutorials</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-physics aria-expanded=false>
Physics</button><div class=collapse id=section-physics><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/physics/analyses/>ColliderBit analysis</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-help aria-expanded=false>
Help</button><div class=collapse id=section-help><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/help/common_problems_and_questions/>Common Problems and Questions</a></li><li><a class="docs-link rounded" href=/documentation/help/compiler_matrix/>Compiler Matrix</a></li><li><a class="docs-link rounded" href=/documentation/help/known_issues/>Known Issues</a></li><li><a class="docs-link rounded" href=/documentation/help/configuration_examples/>Configuration Examples</a></li><li><a class="docs-link rounded" href=/documentation/help/support/>Support</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-code aria-expanded=false>
Code Reference</button><div class=collapse id=section-code><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/code/index_classes/>Classes</a></li><li><a class="docs-link rounded" href=/documentation/code/index_files/>Files</a></li><li><a class="docs-link rounded" href=/documentation/code/index_pages/>Pages</a></li><li><a class="docs-link rounded" href=/documentation/code/index_namespaces/>Namespaces</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#namespaces>Namespaces</a></li><li><a href=#classes>Classes</a></li><li><a href=#source-code>Source code</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#namespaces>Namespaces</a></li><li><a href=#classes>Classes</a></li><li><a href=#source-code>Source code</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=/>Home</a></li><li class=breadcrumb-item><a href=/documentation/>Documentation</a></li><li class=breadcrumb-item><a href=/documentation/code/>Code Reference</a></li><li class="breadcrumb-item active" aria-current=page>file analyses/Analysis_ATLAS_13TeV_2BoostedBosons_139invfb.cpp</li></ol></nav><p class=lead></p><h1 id=file-analyses-analysis-atlas-13tev-2boostedbosons-139invfb-cpp>file analyses/Analysis_ATLAS_13TeV_2BoostedBosons_139invfb.cpp <a href=#file-analyses-analysis-atlas-13tev-2boostedbosons-139invfb-cpp class=anchor aria-hidden=true>#</a></h1><p>[No description available]</p><h2 id=namespaces>Namespaces <a href=#namespaces class=anchor aria-hidden=true>#</a></h2><table><thead><tr><th>Name</th></tr></thead><tbody><tr><td><strong><a href=/documentation/code/namespaces/namespacegambit/>Gambit</a></strong><br>TODO: see if we can use this one:</td></tr><tr><td><strong><a href=/documentation/code/namespaces/namespacegambit_1_1colliderbit/>Gambit::ColliderBit</a></strong></td></tr></tbody></table><h2 id=classes>Classes <a href=#classes class=anchor aria-hidden=true>#</a></h2><table><thead><tr><th></th><th>Name</th></tr></thead><tbody><tr><td>class</td><td><strong><a href=/documentation/code/classes/classgambit_1_1colliderbit_1_1analysis__atlas__13tev__2boostedbosons__139invfb/>Gambit::ColliderBit::Analysis_ATLAS_13TeV_2BoostedBosons_139invfb</a></strong></td></tr></tbody></table><h2 id=source-code>Source code <a href=#source-code class=anchor aria-hidden=true>#</a></h2><pre><code>///
///  \author Are Raklev
///  \date 2021 July
///
///
///  Based on the search presented in 2108.07586.
///
///  WARNING: This implementation only predicts the non-b-jet signal regions due to problems reproducing
///  the b-tagging used based on small radius track jets. Some further limitations are:
///
///  * Due to the lack of mis-tagging probabilities for W- and Z-jets, events will be missing from
///  signal regions not directly corresponding to the produced bosons, e.g. in chargino--neutralino
///  production with decays into W and Z, events would otherwise also be expected in the ZZ signal region
///  due to misidentification of W-jets as Z-jets jets, but this will not be the case with the current
///  inplementation. As a result the most reliable and most constraining signal region will typically be the VV
///  signal region.
///
///  * For b-tagging we take the conservative approach of allowing no events with b-labeled jets and use
///  the mis-tagging probabilities for the small radius track jets for non-b-labeled jets.
///
///  * The separation of E_T^miss and jets in the analysis is done using small radius jets. Here we use the
///  large radius jets since they are the only ones available.
///
///  *********************************************


//#define CHECK_CUTFLOW
//#define BENCHMARK &quot;WW&quot;
//#define BENCHMARK &quot;WZ&quot;
//#define BENCHMARK &quot;Wh&quot;
//#define BENCHMARK &quot;HG&quot;

#include &lt;vector&gt;
#include &lt;cmath&gt;
#include &lt;memory&gt;
#include &lt;iomanip&gt;

#include &quot;gambit/ColliderBit/analyses/Analysis.hpp&quot;
#include &quot;gambit/ColliderBit/ATLASEfficiencies.hpp&quot;
//#include &quot;gambit/ColliderBit/lester_mt2_bisect.h&quot;

//#define CHECK_CUTFLOW

using namespace std;


namespace Gambit
{
  namespace ColliderBit
  {


    class Analysis_ATLAS_13TeV_2BoostedBosons_139invfb : public Analysis
    {

      protected:

        // Signal region map
        std::map&lt;string, EventCounter&gt; _counters = {
          // Exclusion regions
          {&quot;SR-4Q-WW&quot;, EventCounter(&quot;SR-4Q-WW&quot;)},
          {&quot;SR-4Q-WZ&quot;, EventCounter(&quot;SR-4Q-WZ&quot;)},
          {&quot;SR-4Q-ZZ&quot;, EventCounter(&quot;SR-4Q-ZZ&quot;)},
          {&quot;SR-4Q-VV&quot;, EventCounter(&quot;SR-4Q-VV&quot;)},
  //        {&quot;SR-2B2Q-WZ&quot;, EventCounter(&quot;SR-2B2Q-WZ&quot;)},
  //        {&quot;SR-2B2Q-ZZ&quot;, EventCounter(&quot;SR-2B2Q-ZZ&quot;)},
  //        {&quot;SR-2B2Q-Wh&quot;, EventCounter(&quot;SR-2B2Q-Wh&quot;)},
  //        {&quot;SR-2B2Q-Zh&quot;, EventCounter(&quot;SR-2B2Q-Zh&quot;)},
  //        {&quot;SR-2B2Q-VZ&quot;, EventCounter(&quot;SR-2B2Q-VZ&quot;)},
  //        {&quot;SR-2B2Q-Vh&quot;, EventCounter(&quot;SR-2B2Q-Vh&quot;)},
  //        // Discovery regions
  //        {&quot;Disc-SR-2B2Q&quot;, EventCounter(&quot;Disc-SR-2B2Q&quot;)},  // Union of SR-2B2Q-VZ and SR-2B2Q-Vh
  //        {&quot;Disc-SR-Incl&quot;, EventCounter(&quot;Disc-SR-Incl&quot;)},  // Union of SR-4Q-VV and Disc-SR-2B2Q
        };

      public:

        #ifdef CHECK_CUTFLOW
        // Cut-flow variables
        string benchmark = BENCHMARK;
        size_t NCUTS=20;
        vector&lt;double&gt; _cutflow_GAMBIT{vector&lt;double&gt;(NCUTS)};
        vector&lt;double&gt; _cutflow_ATLAS{vector&lt;double&gt;(NCUTS)};
        vector&lt;string&gt; _cuts{vector&lt;string&gt;(NCUTS)};
        // SR yields {4Q-WW, 4Q-WZ, 4Q-ZZ, 4Q-VV, 2B2Q-WZ, 2B2Q-Wh, 2B2Q-ZZ, 2B2Q-Zh, 2B2Q-VZ, 2B2Q-Vh}
        vector&lt;double&gt; _yield_model{vector&lt;double&gt;(10)};
        // meff distribution
        const vector&lt;double&gt; _meff_bins = {700., 850., 1000., 1150., 1300., 1450., 1600., 1750., 1900., 2050., 2200., 2350., 2500,};
        vector&lt;double&gt; _meff_4QVV{vector&lt;double&gt;(12)};
        vector&lt;double&gt; _meff_4QVV_model{vector&lt;double&gt;(12)};
        #endif

        // Required detector sim
        static constexpr const char* detector = &quot;ATLAS&quot;;

        Analysis_ATLAS_13TeV_2BoostedBosons_139invfb()
        {

          set_analysis_name(&quot;ATLAS_13TeV_2BoostedBosons_139invfb&quot;);
          set_luminosity(139.);

        }

        // The following section copied from Analysis_ATLAS_1LEPStop_20invfb.cpp
        void JetLeptonOverlapRemoval(vector&lt;const HEPUtils::Jet*&gt; &amp;jetvec, vector&lt;const HEPUtils::Particle*&gt; &amp;lepvec, double DeltaRMax)
        {
          //Routine to do jet-lepton check
          //Discards jets if they are within DeltaRMax of a lepton

          vector&lt;const HEPUtils::Jet*&gt; Survivors;

          for(unsigned int itjet = 0; itjet &lt; jetvec.size(); itjet++)
          {
            bool overlap = false;
            HEPUtils::P4 jetmom=jetvec.at(itjet)-&gt;mom();
            for(unsigned int itlep = 0; itlep &lt; lepvec.size(); itlep++)
            {
              HEPUtils::P4 lepmom=lepvec.at(itlep)-&gt;mom();
              double dR;

              dR=jetmom.deltaR_eta(lepmom);

              if(fabs(dR) &lt;= DeltaRMax) overlap=true;
            }
            if(overlap) continue;
            Survivors.push_back(jetvec.at(itjet));
          }
          jetvec=Survivors;

          return;
        }

        // Run main event analysis
        void run(const HEPUtils::Event* event)
        {

          // Get the missing energy in the event
          double met = event-&gt;met();
          HEPUtils::P4 metVec = event-&gt;missingmom();

          // Define vectors of baseline leptons
          // Baseline electrons
          vector&lt;const HEPUtils::Particle*&gt; electrons;
          for (const HEPUtils::Particle* electron : event-&gt;electrons())
          {
            if (electron-&gt;pT() &gt; 4.5
                &amp;&amp; fabs(electron-&gt;eta()) &lt; 2.47)
              electrons.push_back(electron);
          }
          // Apply electron efficiency from &quot;Loose&quot; criteria in 1902.04655
          ATLAS::applyElectronIDEfficiency2019(electrons, &quot;Loose&quot;);
          // Baseline muons
          vector&lt;const HEPUtils::Particle*&gt; muons;
          for (const HEPUtils::Particle* muon : event-&gt;muons())
          {
            if (muon-&gt;pT() &gt; 3.
                &amp;&amp; fabs(muon-&gt;eta()) &lt; 2.7)
              muons.push_back(muon);
          }
          // Apply muon efficiency
          ATLAS::applyMuonEffR2(muons);

          // Number of leptons
          size_t nMuons = muons.size();
          size_t nElectrons = electrons.size();
          size_t nLeptons = nElectrons+nMuons;

          // Look at jets to see if they fulfil criteria for fat jets
          vector&lt;const HEPUtils::Jet*&gt; fatJets;
          for (const HEPUtils::Jet* jet : event-&gt;jets(&quot;antikt_R04&quot;))
          {
            //  cout  &lt;&lt; jet-&gt;pT() &lt;&lt; &quot; &quot; &lt;&lt; jet-&gt;mass() &lt;&lt; &quot; Z-tag &quot; &lt;&lt;  jet-&gt;tagged(23) &lt;&lt; &quot; W-tag &quot; &lt;&lt; jet-&gt;tagged(24) &lt;&lt; &quot; &quot; &lt;&lt; endl;
            if (jet-&gt;pT() &gt; 200. &amp;&amp; fabs(jet-&gt;eta()) &lt; 2.0 &amp;&amp; jet-&gt;mass() &gt; 40.)
            {
              fatJets.push_back(jet);
            }
          }
          // Overlap removal (remove fat jets within DR=1 of electrons)
          JetLeptonOverlapRemoval(fatJets, electrons, 1.0);
          size_t nfat = fatJets.size();

          // Tag the large jets (only look at two hardest jets)
          int nW = 0; int nZ = 0; int nH = 0; int ntest = 0;
          const vector&lt;double&gt; bpT = {200., 300., 500., 700., 900., DBL_MAX}; // pT bin edges
          const vector&lt;double&gt; pW = {0.469, 0.475, 0.481, 0.496, 0.522}; // W tag prob
          const vector&lt;double&gt; pWmiss = {1/10.2574, 1/20.2997, 1/33.4745, 1/36.0622, 1/29.1341}; // W misstag prob
          const vector&lt;double&gt; pZ = {0.469, 0.488, 0.513, 0.516, 0.525}; // Z tag prob
          const vector&lt;double&gt; pZmiss = {1/11.5847, 1/18.5291, 1/27.7596, 1/38.4142, 1/26.0997}; // Z misstag prob
          const vector&lt;double&gt; pH = {0.469, 0.488, 0.513, 0.516, 0.525}; // Higgs tag prob TODO: Update with correct numbers
          const HEPUtils::BinnedFn1D&lt;double&gt; _eff1dW(bpT, pW);
          const HEPUtils::BinnedFn1D&lt;double&gt; _eff1dWmiss(bpT, pWmiss);
          const HEPUtils::BinnedFn1D&lt;double&gt; _eff1dZ(bpT, pZ);
          const HEPUtils::BinnedFn1D&lt;double&gt; _eff1dZmiss(bpT, pZmiss);
          const HEPUtils::BinnedFn1D&lt;double&gt; _eff1dH(bpT, pH);
          for (const HEPUtils::Jet* jet : fatJets)
          {
            // Tag W
            if( jet-&gt;tagged(24) &amp;&amp; random_bool( _eff1dW.get_at( jet-&gt;pT() ) ) ) nW++;
            // Tag Z
            if( jet-&gt;tagged(23) &amp;&amp; random_bool( _eff1dZ.get_at( jet-&gt;pT() ) ) ) nZ++;
            // Tag SM Higgs
            if( jet-&gt;tagged(25) &amp;&amp; random_bool( _eff1dH.get_at( jet-&gt;pT() )  ) ) nH++;
            // Misstag as Z or W
            if( !jet-&gt;tagged(23) &amp;&amp; !jet-&gt;tagged(24) )
            {
              if( random_bool( _eff1dZmiss.get_at( jet-&gt;pT() ) )  ) nZ++;
              if( random_bool( _eff1dWmiss.get_at( jet-&gt;pT() ) )  ) nW++;
            }
            ntest++;
            if(ntest &gt; 1) break;
          }
          int nV = nZ + nW;
          //if(nH &gt; 0 ) cout &lt;&lt; &quot;nZ &quot; &lt;&lt; nZ &lt;&lt; &quot; nW &quot; &lt;&lt; nW &lt;&lt; &quot; nV &quot; &lt;&lt; nV &lt;&lt; &quot; nH &quot; &lt;&lt; nH &lt;&lt; endl;

          // b-jet tagging
          // There is a difference here wrt the actual analysis where small
          // variable-radius track jets are used, and the number of such b-jets are
          // counted. This means that the rejection for b-jets in the 4Q SRs has to
          // be changed. We use the conservative choice of rejecting all events with
          // a b-labeled large radius jet and mis-tagging large radius non-b-jets
          // according to the mis-tag probabilities of the small radius track jets.

          // double btag = 0.83;
          double cmisstag = 1/3.; double misstag = 1./33.;
          int nb = 0;
          for ( const HEPUtils::Jet* jet : event-&gt;jets(&quot;antikt_R04&quot;) )
          {
            // Tag b-jet
            if( jet-&gt;btag() ) nb++;
            // Misstag c-jet
            else if( !jet-&gt;btag() &amp;&amp; jet-&gt;ctag() &amp;&amp; random_bool(cmisstag) ) nb++;
            // Misstag light jet
            else if( !jet-&gt;btag() &amp;&amp; !jet-&gt;ctag() &amp;&amp; random_bool(misstag) ) nb++;
          }

          // Check separation of jets and ETmiss
          bool delphi = true;
          for ( const HEPUtils::Jet* jet : fatJets )
          {
            double phi = jet-&gt;mom().deltaPhi(metVec);
            if (phi &lt; 1.0) delphi = false;
          }

          // Effective mass (missing energy plus two leading fatjet pTs)
          double meff = met;
          if(fatJets.size() &gt; 0) meff += fatJets[0]-&gt;pT();
          if(fatJets.size() &gt; 1) meff += fatJets[1]-&gt;pT();


          //
          // Count signal region events
          //

          // Preselection conditions
          if(nfat &gt; 1 &amp;&amp; nLeptons == 0)
          {
            // First exclusion regions
            if(nb == 0 &amp;&amp; delphi)
            {
              if(met &gt; 300. &amp;&amp; meff &gt; 1300. &amp;&amp; nV == 2 &amp;&amp; nW == 2) _counters.at(&quot;SR-4Q-WW&quot;).add_event(event);
              if(met &gt; 300. &amp;&amp; meff &gt; 1300. &amp;&amp; nV == 2 &amp;&amp; nW &gt; 0 &amp;&amp; nZ &gt; 0) _counters.at(&quot;SR-4Q-WZ&quot;).add_event(event);
              if(met &gt; 300. &amp;&amp; meff &gt; 1300. &amp;&amp; nV == 2 &amp;&amp; nZ ==2) _counters.at(&quot;SR-4Q-ZZ&quot;).add_event(event);
              if(met &gt; 300. &amp;&amp; meff &gt; 1300. &amp;&amp; nV == 2) _counters.at(&quot;SR-4Q-VV&quot;).add_event(event);
            }
            if(nb == 1){ }
            // Then discovery regions

          }

          #ifdef CHECK_CUTFLOW
          // Check meff distribution
          if(nfat &gt; 1 &amp;&amp; nLeptons == 0 &amp;&amp; nb == 0 &amp;&amp; delphi &amp;&amp; met &gt; 300. &amp;&amp; nV == 2)
          {
            size_t i = floor((meff-_meff_bins[0])/150);
            if(i &lt; _meff_4QVV.size() ) _meff_4QVV[i]++;
          }
          // Do cut-flow proper
          for(size_t j=0; j&lt;NCUTS; j++)
          {
            if(
               (j==0) ||
               (j==1 &amp;&amp; met &gt; 200) ||
               (j==2 &amp;&amp; met &gt; 200) ||
               (j==3 &amp;&amp; met &gt; 200 &amp;&amp; nLeptons == 0) ||
               (j==4 &amp;&amp; met &gt; 200 &amp;&amp; nLeptons == 0 &amp;&amp; nfat &gt; 1) ||
               (j==5 &amp;&amp; met &gt; 200 &amp;&amp; nLeptons == 0 &amp;&amp; nfat &gt; 1 &amp;&amp; nb == 0) ||
               (j==6 &amp;&amp; met &gt; 200 &amp;&amp; nLeptons == 0 &amp;&amp; nfat &gt; 1 &amp;&amp; nb == 0 &amp;&amp; delphi) ||
               (j==7 &amp;&amp; met &gt; 200 &amp;&amp; nLeptons == 0 &amp;&amp; nfat &gt; 1 &amp;&amp; nb == 0 &amp;&amp; delphi &amp;&amp; nb &lt; 2) ||
               (j==8 &amp;&amp; met &gt; 300 &amp;&amp; nLeptons == 0 &amp;&amp; nfat &gt; 1 &amp;&amp; nb == 0 &amp;&amp; delphi &amp;&amp; nb &lt; 2) ||
               (j==9 &amp;&amp; met &gt; 300 &amp;&amp; nLeptons == 0 &amp;&amp; nfat &gt; 1 &amp;&amp; nb == 0 &amp;&amp; delphi &amp;&amp; nb &lt; 2 &amp;&amp; meff &gt; 1300) ||
               (j==10 &amp;&amp; met &gt; 300 &amp;&amp; nLeptons == 0 &amp;&amp; nfat &gt; 1 &amp;&amp; nb == 0 &amp;&amp; delphi &amp;&amp; nb &lt; 2 &amp;&amp; meff &gt; 1300 &amp;&amp; nV == 2) ||
               (j==11 &amp;&amp; met &gt; 300 &amp;&amp; nLeptons == 0 &amp;&amp; nfat &gt; 1 &amp;&amp; nb == 0 &amp;&amp; delphi &amp;&amp; nb &lt; 2 &amp;&amp; meff &gt; 1300 &amp;&amp; nV == 2) ||
               (j==12 &amp;&amp; met &gt; 300 &amp;&amp; nLeptons == 0 &amp;&amp; nfat &gt; 1 &amp;&amp; delphi &amp;&amp; nH == 1)
               ) _cutflow_GAMBIT[j]++;
          }
          #endif


        } // End of analyze


        /// Combine the variables of another copy of this analysis (typically on another thread) into this one.
        void combine(const Analysis* other)
        {
          const Analysis_ATLAS_13TeV_2BoostedBosons_139invfb* specificOther = dynamic_cast&lt;const Analysis_ATLAS_13TeV_2BoostedBosons_139invfb*&gt;(other);
          for (auto&amp; pair : _counters) { pair.second += specificOther-&gt;_counters.at(pair.first); }
        }


        void collect_results()
        {

          // Now fill a results object with the results for each SR
          add_result(SignalRegionData(_counters.at(&quot;SR-4Q-WW&quot;),   2., {1.9, 0.4}));
          add_result(SignalRegionData(_counters.at(&quot;SR-4Q-WZ&quot;),   3., {3.4, 0.7}));
          add_result(SignalRegionData(_counters.at(&quot;SR-4Q-ZZ&quot;),   1., {1.9, 0.5}));
          add_result(SignalRegionData(_counters.at(&quot;SR-4Q-VV&quot;),   3., {3.9, 0.8}));
  //        add_result(SignalRegionData(_counters.at(&quot;SR-2B2Q-WZ&quot;), 2., {1.6, 0.4}));
  //        add_result(SignalRegionData(_counters.at(&quot;SR-2B2Q-ZZ&quot;), 2., {1.7, 0.5}));
  //        add_result(SignalRegionData(_counters.at(&quot;SR-2B2Q-Wh&quot;), 0., {1.9, 0.7}));
  //        add_result(SignalRegionData(_counters.at(&quot;SR-2B2Q-Zh&quot;), 1., {1.6, 0.5}));
  //        add_result(SignalRegionData(_counters.at(&quot;SR-2B2Q-VZ&quot;), 2., {2.2, 0.6}));
  //        add_result(SignalRegionData(_counters.at(&quot;SR-2B2Q-Vh&quot;), 1., {2.5, 0.8}));
  //        add_result(SignalRegionData(_counters.at(&quot;Disc-SR-2B2Q&quot;), 3., {4.7, 1.0})); // Union of SR-2B2Q-VZ and SR-2B2Q-Vh
  //        add_result(SignalRegionData(_counters.at(&quot;Disc-SR-Incl&quot;), 6., {8.6, 1.3})); // Union of SR-4Q-VV and Disc-SR-2B2Q

          #ifdef CHECK_CUTFLOW
          cout &lt;&lt; &quot;Cut flow for &quot; &lt;&lt; benchmark &lt;&lt; endl;

          double _xsec_model;
          double _lumi = luminosity();

          _cuts = {&quot;Initial events&quot;, &quot;E_T^miss &gt; 200 GeV&quot;, &quot;Event cleaning&quot;, &quot;Lepton veto&quot;, &quot;n_jets &gt; 1&quot;, &quot;n_bjets = 0&quot;, &quot;min Delta phi &gt; 1.0&quot;, &quot;n_bjets &lt; 2&quot;, &quot;E_T^miss &gt; 300 GeV&quot;, &quot;m_eff &gt; 1300 GeV&quot;, &quot;n_V = 2&quot;, &quot;MC to data efficiency weight for SR-4Q-VV&quot;, &quot;n_H = 1&quot; };

          if(benchmark == &quot;WZ&quot;)
          {
            _yield_model = {3.5967, 6.3812, 4.1271, 6.7624, 2.0387, 0.3481, 1.8895, 0.2818, 2.3702, 0.3812};
            _meff_4QVV_model = {0.0, 0.30543, 0.62458, 1.264, 1.4178, 1.493, 1.2082, 0.9881, 0.65451, 0.35119, 0.29642, 0.0};
            _cutflow_ATLAS = {348.29, 287.73, 245.63, 172.60, 68.52, 64.64, 44.91, 35.02, 31.90, 23.74, 8.00, 6.76, 7.65, 6.60, 6.35, 3.61, 2.65, 2.34, 0.39, 0.36};
            _xsec_model = 2.52;
          }
          else if(benchmark == &quot;WW&quot;)
          {
            _meff_4QVV_model = {0.15911, 1.1519, 2.1652, 2.3533, 2.302, 1.3157, 0.70599, 0.39097, 0.22347, 0.12507, 0.0, 0.0};
            _cutflow_ATLAS = {619.20, 466.99, 395.78, 241.87, 85.18, 81.22, 58.13, 52.01, 42.78, 20.11, 6.21, 5.28, 2.06, 1.60, 1.57, 0.68, 0.40, 0.34, 0.02, 0.02};
            _xsec_model = 4.42;
          }
          else if(benchmark == &quot;Wh&quot;)
          {
            _yield_model = {0.3812, 0.6961, 0.4475, 0.7459, 1.1934, 5.2044, 0.8287, 3.6961, 1.2597, 5.5359};
            _cutflow_ATLAS = {348.29, 244.06, 207.07, 156.57, 67.95, 62.74, 42.83, 19.83, 17.67, 12.66, 0.78, 0.73, 19.23, 16.67, 16.08, 8.80, 1.40, 1.27, 6.03, 5.54};
            _xsec_model = 2.52;
          }
          else if(benchmark == &quot;HG&quot;)
          {
            _yield_model = {0.8122, 1.5746, 1.2597, 1.8398, 1.5083, 2.0552, 1.9558, 3.0000, 2.1878, 3.2818};
            _meff_4QVV_model = {0.0, 0.1461, 0.56213, 0.43614, 0.4357, 0.66339, 0.40393, 0.1648, 0.0, 0.0, 0.0, 0.0};
            _cutflow_ATLAS = {482.87, 395.66, 336.46, 259.61, 85.00, 76.52, 53.05, 22.99, 19.99, 12.20, 2.08, 1.85, 26.28, 21.97, 20.47, 8.10, 2.55, 2.21, 3.75, 3.29};
            _xsec_model = 3.47;
          }
          double _scale = _xsec_model*_lumi/50000; // Weights of less than 0.01
          cout &lt;&lt; &quot;Event scaling factor: &quot; &lt;&lt; _scale &lt;&lt; endl;

          // Compare final event yield per SR for model
          cout &lt;&lt; &quot;SR\t\t&quot; &lt;&lt; &quot;GAMBIT\t&quot; &lt;&lt; &quot;ATLAS&quot; &lt;&lt; endl;
          cout &lt;&lt; &quot;SR-4Q-WW\t&quot; &lt;&lt; _counters.at(&quot;SR-4Q-WW&quot;).sum()*_scale &lt;&lt; &quot;\t&quot; &lt;&lt; _yield_model[0] &lt;&lt; endl;
          cout &lt;&lt; &quot;SR-4Q-WZ\t&quot; &lt;&lt; _counters.at(&quot;SR-4Q-WZ&quot;).sum()*_scale &lt;&lt; &quot;\t&quot; &lt;&lt; _yield_model[1] &lt;&lt; endl;
          cout &lt;&lt; &quot;SR-4Q-ZZ\t&quot; &lt;&lt; _counters.at(&quot;SR-4Q-ZZ&quot;).sum()*_scale &lt;&lt; &quot;\t&quot; &lt;&lt; _yield_model[2] &lt;&lt; endl;
          cout &lt;&lt; &quot;SR-4Q-VV\t&quot; &lt;&lt; _counters.at(&quot;SR-4Q-VV&quot;).sum()*_scale &lt;&lt; &quot;\t&quot; &lt;&lt; _yield_model[3] &lt;&lt; endl;
          cout &lt;&lt; endl;

          // Compare meff spectrum
          cout &lt;&lt; &quot;Meff SR-4Q-VV\t&quot; &lt;&lt; &quot;GAMBIT\t&quot; &lt;&lt; &quot;ATLAS &quot; &lt;&lt; endl;
          for (size_t j = 0; j &lt; _meff_4QVV.size(); j++){
            cout &lt;&lt; &quot;[&quot; &lt;&lt; _meff_bins[j] &lt;&lt; &quot;, &quot; &lt;&lt; _meff_bins[j+1] &lt;&lt; &quot;]\t&quot; &lt;&lt; _meff_4QVV[j]*_scale &lt;&lt; &quot;\t&quot; &lt;&lt; _meff_4QVV_model[j] &lt;&lt; endl;
          }

          // Compare cut-flow
          cout &lt;&lt; fixed &lt;&lt; setprecision(2);
          cout &lt;&lt; &quot;    GAMBIT\tMC error\tATLAS\t\tRatio\t\tCut&quot; &lt;&lt;endl;
          for (size_t i=0; i&lt;NCUTS; i++) {
            cout &lt;&lt; i &lt;&lt; &quot;:  &quot; &lt;&lt;  _cutflow_GAMBIT[i]*_scale &lt;&lt; &quot;\t\t&quot; &lt;&lt; sqrt(_cutflow_GAMBIT[i])*_scale &lt;&lt; &quot;\t\t&quot; &lt;&lt; _cutflow_ATLAS[i] &lt;&lt;  &quot;\t\t&quot; &lt;&lt; _cutflow_GAMBIT[i]*_scale/_cutflow_ATLAS[i]  &lt;&lt; &quot;\t\t&quot; &lt;&lt; _cuts[i] &lt;&lt;endl;
          }


          #endif

        }

        void analysis_specific_reset()
        {
          // Clear signal regions
          for (auto&amp; pair : _counters) { pair.second.reset(); }
        }

    };


    // Factory fn
    DEFINE_ANALYSIS_FACTORY(ATLAS_13TeV_2BoostedBosons_139invfb)

  }
}


/*


 ****
 WW (WW final states)

 SR        GAMBIT  ATLAS
 SR-4Q-VV  5.332    5.065

 Meff SR-4Q-VV  GAMBIT  ATLAS
 [700, 850]  0.233  0.159
 [850, 1e+03]  1.14  1.15
 [1e+03, 1.15e+03]  1.71  2.17
 [1.15e+03, 1.3e+03]  2.58  2.35
 [1.3e+03, 1.45e+03]  2.22  2.3
 [1.45e+03, 1.6e+03]  1.13  1.32
 [1.6e+03, 1.75e+03]  0.872  0.706
 [1.75e+03, 1.9e+03]  0.553  0.391
 [1.9e+03, 2.05e+03]  0.258  0.223
 [2.05e+03, 2.2e+03]  0.147  0.125
 [2.2e+03, 2.35e+03]  0.0492  0
 [2.35e+03, 2.5e+03]  0.0246  0

     GAMBIT  MC error  ATLAS    Ratio    Cut
 0:  614.38    2.75    619.20    0.99    Initial events
 1:  477.58    2.42    466.99    1.02    E_T^miss &gt; 200 GeV
 2:  477.58    2.42    395.78    1.21    Event cleaning
 3:  290.39    1.89    241.87    1.20    Lepton veto
 4:  115.81    1.19    85.18    1.36    n_jets &gt; 1
 5:  75.69    0.96    81.22    0.93    n_bjets = 0
 6:  63.47    0.88    58.13    1.09    min Delta phi &gt; 1.0
 7:  63.47    0.88    52.01    1.22    n_bjets &lt; 2
 8:  51.79    0.80    42.78    1.21    E_T^miss &gt; 300 GeV
 9:  24.59    0.55    20.11    1.22    m_eff &gt; 1300 GeV
 10:  5.33    0.26    6.21    0.86    n_V = 2
 11:  5.33    0.26    5.28    1.01    MC to data efficiency weight


 ****
 HG (ZZ final states)

 Cut-flow output
 SR    GAMBIT  ATLAS
 SR-4Q-WW  0  0.812
 SR-4Q-WZ  0.143  1.57
 SR-4Q-ZZ  0.976  1.26
 SR-4Q-VV  1.12  1.84

 Meff SR-4Q-VV  GAMBIT  ATLAS
 [700, 850]  0.013  0
 [850, 1e+03]  0.0585  0.146
 [1e+03, 1.15e+03]  0.215  0.562
 [1.15e+03, 1.3e+03]  0.254  0.436
 [1.3e+03, 1.45e+03]  0.319  0.436
 [1.45e+03, 1.6e+03]  0.293  0.663
 [1.6e+03, 1.75e+03]  0.182  0.404
 [1.75e+03, 1.9e+03]  0.137  0.165
 [1.9e+03, 2.05e+03]  0.0585  0
 [2.05e+03, 2.2e+03]  0.052  0
 [2.2e+03, 2.35e+03]  0.026  0
 [2.35e+03, 2.5e+03]  0  0

     GAMBIT  MC error  ATLAS    Ratio    Cut
 0:  482.33    2.16    482.87    1.00    Initial events
 1:  399.01    1.96    395.66    1.01    E_T^miss &gt; 200 GeV
 2:  399.01    1.96    336.46    1.19    Event cleaning
 3:  321.78    1.76    259.61    1.24    Lepton veto
 4:  135.22    1.14    85.00    1.59    n_jets &gt; 1
 5:  31.12    0.55    76.52    0.41    n_bjets = 0
 6:  24.98    0.49    53.05    0.47    min Deltaphi &gt; 1.0
 7:  24.98    0.49    22.99    1.09    n_bjets &lt; 2
 8:  21.30    0.45    19.99    1.07    E_T^miss &gt; 300 GeV
 9:  13.70    0.36    12.20    1.12    m_eff &gt; 1300 GeV
 10:  1.66    0.13    2.08    0.80    n_V = 2
 11:  1.66    0.13    1.85    0.90    MC to data efficiency weight


 ****
 WZ (WZ final states)

 Cut-flow output
 SR    GAMBIT  ATLAS
 SR-4Q-WW  0.049  3.6
 SR-4Q-WZ  6.47  6.38
 SR-4Q-ZZ  0.056  4.13
 SR-4Q-VV  6.57  6.76

 Meff SR-4Q-VV  GAMBIT  ATLAS
 [700, 850]  0.00701  0
 [850, 1e+03]  0.231  0.305
 [1e+03, 1.15e+03]  0.673  0.625
 [1.15e+03, 1.3e+03]  0.911  1.26
 [1.3e+03, 1.45e+03]  1.43  1.42
 [1.45e+03, 1.6e+03]  1.36  1.49
 [1.6e+03, 1.75e+03]  1.11  1.21
 [1.75e+03, 1.9e+03]  0.974  0.988
 [1.9e+03, 2.05e+03]  0.595  0.655
 [2.05e+03, 2.2e+03]  0.364  0.351
 [2.2e+03, 2.35e+03]  0.273  0.296
 [2.35e+03, 2.5e+03]  0.182  0

     GAMBIT  MC error  ATLAS    Ratio    Cut
 0:  350.28    1.57    348.29    1.01    Initial events
 1:  297.58    1.44    287.73    1.03    E_T^miss &gt; 200 GeV
 2:  297.58    1.44    245.63    1.21    Event cleaning
 3:  211.46    1.22    172.60    1.23    Lepton veto
 4:  93.52    0.81    68.52    1.36    n_jets &gt; 1
 5:  51.04    0.60    64.64    0.79    n_bjets = 0
 6:  42.83    0.55    44.91    0.95    min Deltaphi &gt; 1.0
 7:  42.83    0.55    35.02    1.22    n_bjets &lt; 2
 8:  37.93    0.52    31.90    1.19    E_T^miss &gt; 300 GeV
 9:  28.74    0.45    23.74    1.21    m_eff &gt; 1300 GeV
 10:  6.57    0.21    8.00    0.82    n_V = 2
 11:  6.57    0.21    6.76    0.97    MC to data efficiency weight


 ***
 Wh (Wbb, WWW^*, WZZ^* final states)

 Cut-flow output
 SR    GAMBIT  ATLAS
 SR-4Q-WW  0.294  0.381
 SR-4Q-WZ  0.252  0.696
 SR-4Q-ZZ  0  0.448
 SR-4Q-VV  0.546  0.746

     GAMBIT  MC error  ATLAS    Ratio    Cut
 0:  350.28    1.57    348.29    1.01    Initial events
 1:  303.19    1.46    244.06    1.24    E_T^miss &gt; 200 GeV
 2:  303.19    1.46    207.07    1.46    Event cleaning
 3:  205.39    1.20    156.57    1.31    Lepton veto
 4:  105.13    0.86    67.95    1.55    n_jets &gt; 1
 5:  24.27    0.41    62.74    0.39    n_bjets = 0
 6:  20.20    0.38    42.83    0.47    min Deltaphi &gt; 1.0
 7:  20.20    0.38    19.83    1.02    n_bjets &lt; 2
 8:  17.95    0.35    17.67    1.02    E_T^miss &gt; 300 GeV
 9:  13.04    0.30    12.66    1.03    m_eff &gt; 1300 GeV
 10:  0.55    0.06    0.78    0.70    n_V = 2
 11:  0.55    0.06    0.73    0.75    MC to data efficiency weight


 */
</code></pre><hr><p>Updated on 2025-02-12 at 16:10:35 +0000</p></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://gohugo.io/>Hugo</a> and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/license/>License</a></li></ul></div></div></div></footer><script src=/js/bootstrap.min.862c9eb8ab97f8c1c8584b21ce31113d8553917669561b040011b0061009a0b6c7a6b61fb659f56eabfa9f45259f001417dba1d65b229f685f3cdbb709482f8e.js integrity="sha512-hiyeuKuX+MHIWEshzjERPYVTkXZpVhsEABGwBhAJoLbHprYftln1bqv6n0UlnwAUF9uh1lsin2hfPNu3CUgvjg==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.3fa03d1d36ae7a66d6d5d2e19796832d40b4a5417eaaae1dfba8837d033467084e8c051f25aee596d415422573116115ccc5c2b29970d3490dafdce1a920a402.js integrity="sha512-P6A9HTauembW1dLhl5aDLUC0pUF+qq4d+6iDfQM0ZwhOjAUfJa7lltQVQiVzEWEVzMXCsplw00kNr9zhqSCkAg==" crossorigin=anonymous defer></script>
<script src=/main.min.04459eeb2d9d601a3ccc10d2699fb84f0442d5f5d3a16372b023be7564838ed2a755b908598f715d6b42c0be95895835b2e872f4fa4acd028ef3904671a92f1a.js integrity="sha512-BEWe6y2dYBo8zBDSaZ+4TwRC1fXToWNysCO+dWSDjtKnVbkIWY9xXWtCwL6ViVg1suhy9PpKzQKO85BGcakvGg==" crossorigin=anonymous defer></script>
<script src=https://gambitbsm.org/index.min.0e5dc0d6ae6ec888ba8315ccfe8a57589eca2ed96d4f8f38cf8d86f7f044f6c095a7ba5585214148bb74081529bb52082b38e6df07ae8407f0459ca64ac91e87.js integrity="sha512-Dl3A1q5uyIi6gxXM/opXWJ7KLtltT484z42G9/BE9sCVp7pVhSFBSLt0CBUpu1IIKzjm3weuhAfwRZymSskehw==" crossorigin=anonymous defer></script></body></html>