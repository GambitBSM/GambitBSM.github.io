<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var e=localStorage.getItem("theme");e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=/main.f8151591b2672085f0933fc9a990f490d47a5bae835eba13e592ae582ffe5e3a9177998e140a75a274da31357b8222d58a74d4a9f10720e05b02bc2a37e6f0ec.css integrity="sha512-+BUVkbJnIIXwkz/JqZD0kNR6W66DXroT5ZKuWC/+XjqRd5mOFAp1onTaMTV7giLVinTUqfEHIOBbArwqN+bw7A==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>file src/ModGrav.cpp - GAMBIT</title><meta name=description content="[No description available]"><link rel=canonical href=/documentation/code/files/modgrav_8cpp/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="file src/ModGrav.cpp"><meta property="og:description" content="[No description available]"><meta property="og:url" content="/documentation/code/files/modgrav_8cpp/"><meta property="og:site_name" content="GAMBIT"><meta property="og:image" content="/gambit_logo.png"><meta property="og:image:alt" content="GAMBIT"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content><meta name=twitter:creator content><meta name=twitter:title content="file src/ModGrav.cpp"><meta name=twitter:description content="[No description available]"><meta name=twitter:image content="/gambit_logo.png"><meta name=twitter:image:alt content="file src/ModGrav.cpp"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"/#/schema/organization/1","name":"Doks","url":"/","sameAs":["https://github.com/GambitBSM"],"logo":{"@type":"ImageObject","@id":"/#/schema/image/1","url":"/logo-doks.png","width":450,"height":416,"caption":"Doks"},"image":{"@id":"/#/schema/image/1"}},{"@type":"WebSite","@id":"/#/schema/website/1","url":"/","name":"GAMBIT","description":"Documentation for GAMBIT, the Global And Modular BSM Inference Tool","publisher":{"@id":"/#/schema/organization/1"}},{"@type":"WebPage","@id":"/documentation/code/files/modgrav_8cpp/","url":"/documentation/code/files/modgrav_8cpp/","name":"file src\/ModGrav.cpp","description":"[No description available]","isPartOf":{"@id":"/#/schema/website/1"},"about":{"@id":"/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"/documentation/code/files/modgrav_8cpp/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"/documentation/code/files/modgrav_8cpp/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["/documentation/code/files/modgrav_8cpp/"]}]},{"@type":"BreadcrumbList","@id":"/documentation/code/files/modgrav_8cpp/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/","url":"/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"/documentationcodefilesmodgrav_8cpp/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"/documentation/code/files/modgrav_8cpp/#/schema/image/2","url":"/gambit_logo.png","contentUrl":"/gambit_logo.png","caption":"file src\/ModGrav.cpp"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=/site.webmanifest></head><body class="documentation single light"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=/ aria-label=GAMBIT><img class=logo-light src=/gambit_logo.png width=50px>
<img class="logo-dark d-none" src=/gambit_logo.png width=50px>
GAMBIT</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>GAMBIT</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Releases
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.4>GAMBIT 2-4 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.3>GAMBIT 2-3 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.2>GAMBIT 2-2 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.1>GAMBIT 2-1 ⧉</a></li><li><a class=dropdown-item href=https://github.com/GambitBSM/gambit_2.4/tags>All releases ⧉</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Documentation
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/documentation/installation/introduction/>Installation</a></li><li><a class=dropdown-item href=/documentation/tutorials/the_gambit_interface>Tutorials</a></li><li><a class=dropdown-item href=/documentation/help/common_problems_and_questions/>Help</a></li><li><a class=dropdown-item href=/documentation/code/index_classes>Code Reference</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Community
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/community/publications/>Publications</a></li><li><a class=dropdown-item href=/community/talks/>Talks</a></li><li><a class=dropdown-item href=/community/members/>Members</a></li><li><a class=dropdown-item href=/community/code_of_conduct/>Code of Conduct</a></li><li><a class=dropdown-item href=/community/contact/>Contact</a></li></ul></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search site..." aria-label="Search site..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/GambitBSM><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-installation aria-expanded=false>
Installation</button><div class=collapse id=section-installation><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/installation/introduction/>Getting Started</a></li><li><a class="docs-link rounded" href=/documentation/installation/docker_usage/>Docker Usage</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_linux/>Installation for Linux</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_windows/>Installation for Windows</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_macos/>Installation for macOS</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-tutorials aria-expanded=false>
Tutorials</button><div class=collapse id=section-tutorials><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/tutorials/the_gambit_interface/>1 - The GAMBIT Interface</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-help aria-expanded=false>
Help</button><div class=collapse id=section-help><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/help/common_problems_and_questions/>Common Problems and Questions</a></li><li><a class="docs-link rounded" href=/documentation/help/compiler_matrix/>Compiler Matrix</a></li><li><a class="docs-link rounded" href=/documentation/help/known_issues/>Known Issues</a></li><li><a class="docs-link rounded" href=/documentation/help/configuration_examples/>Configuration Examples</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-code aria-expanded=false>
Code Reference</button><div class=collapse id=section-code><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/code/index_classes/>Classes</a></li><li><a class="docs-link rounded" href=/documentation/code/index_files/>Files</a></li><li><a class="docs-link rounded" href=/documentation/code/index_pages/>Pages</a></li><li><a class="docs-link rounded" href=/documentation/code/index_namespaces/>Namespaces</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#detailed-description>Detailed Description</a></li><li><a href=#source-code>Source code</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#detailed-description>Detailed Description</a></li><li><a href=#source-code>Source code</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=/>Home</a></li><li class=breadcrumb-item><a href=/documentation/>Documentation</a></li><li class=breadcrumb-item><a href=/documentation/code/>Code Reference</a></li><li class="breadcrumb-item active" aria-current=page>file src/ModGrav.cpp</li></ol></nav><p class=lead></p><h1 id=file-src-modgrav-cpp>file src/ModGrav.cpp <a href=#file-src-modgrav-cpp class=anchor aria-hidden=true>#</a></h1><p>[No description available] <a href=#detailed-description>More&mldr;</a></p><h2 id=detailed-description>Detailed Description <a href=#detailed-description class=anchor aria-hidden=true>#</a></h2><p><strong>Author</strong>: Anna Liang (<a href=mailto:a.liang1@uqconnect.edu.au>a.liang1@uqconnect.edu.au</a>)</p><p><strong>Date</strong>: 2021 Aug</p><hr><p>CosmoBit routines relating to modified gravity models. Currently includes solar system tests.</p><hr><p>Authors (add name and date if you modify):</p><h2 id=source-code>Source code <a href=#source-code class=anchor aria-hidden=true>#</a></h2><pre><code>//   GAMBIT: Global and Modular BSM Inference Tool
//   *********************************************
///  \file
///
///  CosmoBit routines relating to modified gravity models.
///  Currently includes solar system tests.
///
///  *********************************************
///  Authors (add name and date if you modify):
///  \author Anna Liang
///          (a.liang1@uqconnect.edu.au)
///  \date 2021 Aug
///  *********************************************
 
// TODO: Temporarily disabled until project is ready
/*
#include &lt;string&gt;
#include &lt;iostream&gt;
#include &lt;cmath&gt;
#include &lt;fstream&gt;
#include &lt;sstream&gt;
#include &lt;vector&gt;
#include &lt;iomanip&gt;

#include &quot;gambit/Utils/yaml_options.hpp&quot;
#include &quot;gambit/Utils/ascii_dict_reader.hpp&quot;
#include &quot;gambit/Elements/gambit_module_headers.hpp&quot;
#include &quot;gambit/CosmoBit/CosmoBit_rollcall.hpp&quot;
#include &quot;gambit/CosmoBit/CosmoBit_types.hpp&quot;

namespace Gambit
{

  namespace CosmoBit
  {
    using namespace LogTags;

    // Obtain the grid of phi(0) for a given M and mu by interpolating pre-calculated values
    // from the data file CosmoBit/data/phiOvals.dat
    void interp_phi0 (double &amp;result)
    {
      using namespace Pipes::interp_phi0;
      using namespace std;

      const double M_pl = 2.453e18; // [Gev/c^2] reduced planck mass

      // Read in the data file on the first time the function calls
      static bool firsttime = true;
      static double minmass, maxmass, minmu, maxmu; // bounds on mass and mu
      static int nmasses, nmu; // grid sizes of mass and mu
      static vector &lt;double&gt; phi0vec; // vector to store phi0 vals
      static vector &lt;double&gt; massvec, muvec; // vector to store the mass and mu points of grid

      if (firsttime == true){
        // Create a file stream for file to open the .dat file of phi0 values
        ifstream datafile;
        str filename = runOptions-&gt;getValueOrDef&lt;str&gt;(GAMBIT_DIR &quot;/CosmoBit/data/phi0vals.dat&quot;, &quot;filepath&quot;);
        datafile.open(filename);
        if(!datafile.is_open()){
          CosmoBit_error().raise(LOCAL_INFO, &quot;Failed to open file phi0vals.dat in specified directory.&quot;);
        }
        // Obtain the first line of data file as a string stream and convert to store parameters as double values
        str line1;
        getline(datafile, line1);
        istringstream iss(line1);

        vector &lt;double&gt; vecinputs (6, 0.0e0);
        for (int i=0; i&lt;6; i++){
          iss &gt;&gt; vecinputs.at(i);
        }

        // Store the read in parameters as static variables
        minmass = vecinputs.at(0);
        maxmass = vecinputs.at(1);
        nmasses = vecinputs.at(2);
        minmu = vecinputs.at(3);
        maxmu = vecinputs.at(4);
        nmu = vecinputs.at(5);

        // Then read in the rest of the file as a vector
        double num = 0; // to check file reading against
        while (datafile &gt;&gt; num) {
          phi0vec.push_back(num);
        }

        // Generate a vector of masses in GeV
        double steplogmass = (log10(maxmass/M_pl)-log10(minmass/M_pl))/(nmasses-1);
        massvec.resize(nmasses, 0.0e0);
        for (int i=0; i&lt;nmasses; i++){
          massvec.at(i) = pow(10, log10(maxmass/M_pl)-i*steplogmass)*M_pl;
        }

        // Generate a vector of mu vals in GeV
        double steplogmu = (log10(maxmu)-log10(minmu))/(nmu-1);
        muvec.resize(nmu, 0.0e0);
        for (int i=0; i&lt;nmu; i++){
          muvec.at(i) = pow(10, log10(maxmu)-i*steplogmu);
        }

        datafile.close();
        firsttime = false;
      }

      // Interpolate the table to obtain desired phi(0) for a given M and mu
      double inputmass, inputmu;
      if (ModelInUse(&quot;symmetron&quot;)) {
        double powmass, powmu;
        powmass = *Param[&quot;mass&quot;];
        inputmass = pow(10, powmass)*M_pl;
        powmu = *Param[&quot;mu&quot;];
        inputmu = pow(10, powmu);
      } else
      {
         CosmoBit_error().raise(LOCAL_INFO,&quot;Whoops, you are not scanning the model &quot;
          &quot; symmetron! There is probably a bug CosmoBit_rollcall.hpp; this module &quot;
          &quot; function should have ALLOW_MODELS(symmetron) defined.&quot;);
      }

      // Check the input mass and mu are within interpolation range
      if (inputmass &gt; maxmass){
        CosmoBit_error().raise(LOCAL_INFO,&quot;Input mass chosen greater than interpolating range.&quot;);
      }
      if (inputmass &lt; minmass){
        CosmoBit_error().raise(LOCAL_INFO,&quot;Input mass chosen smaller than interpolating range.&quot;);
      }
      if (inputmu &gt; maxmu) {
        CosmoBit_error().raise(LOCAL_INFO,&quot;Input mu chosen greater than interpolating range.&quot;);
      }
      if (inputmu &lt; minmu) {
        CosmoBit_error().raise(LOCAL_INFO,&quot;Input mu chosen smaller than interpolating range.&quot;);
      }

      // Find x0, x1, y0, y1 where x is mass and y is mu
      int ix0, ix1, jy0, jy1;
      double x0, x1, y0, y1;

      for (int i=0; i&lt;nmasses-1; i++){
        // massvec gets smaller from first element to last
        if (inputmass &lt;= massvec.at(i) &amp;&amp; inputmass &gt;= massvec.at(i+1)){
          ix0 = i+1;
          ix1 = i;
          x0 = massvec.at(ix0);
          x1 = massvec.at(ix1);
          break;
        }
      }

      for (int j=0; j&lt;nmu-1; j++){
        // muvec gets bigger from first element to last
        if (inputmu &lt;= muvec.at(j) &amp;&amp; inputmu &gt;= muvec.at(j+1)){
          jy0 = j+1;
          jy1 = j;
          y0 = muvec.at(jy0);
          y1 = muvec.at(jy1);
          break;
        }
      }

      // Find what corresponding phi(0) values are
      double z00 = phi0vec.at(jy0+ix0*nmu);
      double z01 = phi0vec.at(jy1+ix0*nmu);
      double z10 = phi0vec.at(jy0+ix1*nmu);
      double z11 = phi0vec.at(jy1+ix1*nmu);

      // Then interpolate to obtain the phi0(mass, mu) we want
      double yfrac = (inputmu - y0)/(y1-y0);
      double xfrac = (inputmass - x0)/(x1-x0);
      double interpphi0 = (1.0-yfrac)*((1.0-xfrac)*z00+xfrac*z10)+yfrac*((1.0-xfrac)*z01+xfrac*z11);

      result = interpphi0;
      // Print parameters to check function is interpolating correctly
      // cout &lt;&lt; &quot;Mass = &quot; &lt;&lt; inputmass &lt;&lt; endl;
      // cout &lt;&lt; &quot;Mu = &quot; &lt;&lt; inputmu &lt;&lt; endl;
      // cout &lt;&lt; &quot;phi(0) = &quot; &lt;&lt; result &lt;&lt; endl;
    }

    // Calculate Brans-Dicke parameter omega using symmetron parameters mass and v
    void compute_omega (double &amp;result)
    {
      using namespace Pipes::compute_omega;

      double phival = *Pipes::compute_omega::Dep::phi0_interpolation; // obtain from interpolating function
      const double M_pl = 2.453e18; // [Gev/c^2] reduced planck mass
      double omega = 0.0e0; // to store the value of omega

     if (ModelInUse(&quot;symmetron&quot;))
      {
        // Input parameters are given as powers so convert to GeV/c^2
        double powmass = *Param[&quot;mass&quot;];
        double mass = pow(10, powmass)*M_pl;
        double powv = *Param[&quot;vval&quot;];
        double vval = pow(10, powv)*M_pl;

        if(Utils::isnan(mass) or Utils::isnan(vval))
        {
          CosmoBit_error().raise(LOCAL_INFO,&quot;NaN detected in input parameters for model&quot;
          &quot; symmetron! This may indicate a bug in the scanner plugin you are using.&quot;);
        }
        omega = 0.5*(0.5*pow(pow(mass,2.0)/(M_pl*phival*vval), 2.0)-3);
      } else
      {
         CosmoBit_error().raise(LOCAL_INFO,&quot;Whoops, you are not scanning the model &quot;
          &quot; symmetron! There is probably a bug CosmoBit_rollcall.hpp; this module &quot;
          &quot; function should have ALLOW_MODELS(symmetron) defined.&quot;);
      }

      // Store the result as omega
      result = omega;
    }

  // Calculate gamma using brans-dicke parameter omega
   void compute_gammaminus1 (double &amp;result)
   {
     result = fabs(1.0/(2.0+ *Pipes::compute_gammaminus1::Dep::omega_bdparam));
     // cout &lt;&lt; &quot;|gamma-1| = &quot; &lt;&lt; result &lt;&lt; endl;
   }

   // Calculate |beta-1| parameter using brans-dicke parameter omega
    void compute_betaminus1 (double &amp;result)
    {
      using namespace Pipes::compute_betaminus1;

      double omega = *Pipes::compute_betaminus1::Dep::omega_bdparam;
      double phi0 = *Pipes::compute_betaminus1::Dep::phi0_interpolation;
      double mass, vval;
      const double M_pl = 2.453e18; // [Gev/c^2] reduced planck mass

      if (ModelInUse(&quot;symmetron&quot;))
       {
         // read in input parameters
         double powmass = *Param[&quot;mass&quot;];
         mass = pow(10, powmass)*M_pl;
         double powv = *Param[&quot;vval&quot;];
         vval = pow(10, powv)*M_pl;

         if(Utils::isnan(mass))
         {
           CosmoBit_error().raise(LOCAL_INFO,&quot;NaN detected in input parameters for model&quot;
           &quot; symmetron! This may indicate a bug in the scanner plugin you are using.&quot;);
         }
       } else
       {
          CosmoBit_error().raise(LOCAL_INFO,&quot;Whoops, you are not scanning the model &quot;
           &quot; symmetron! There is probably a bug CosmoBit_rollcall.hpp; this module &quot;
           &quot; function should have ALLOW_MODELS(symmetron) defined.&quot;);
       }

      double deriv = -2*pow(1+phi0*phi0*vval*vval/(2*mass*mass),-3.0)*2*phi0*vval/(2*mass*mass);
      result = fabs(1/(pow(3+2*omega,2.0)*(4+2*omega))*1.0/deriv);
      // cout &lt;&lt; &quot;|beta-1| = &quot; &lt;&lt; result &lt;&lt; endl;
    }

    // A likelihood function for comparing the model eta to the mars perihelion value
    void lnL_eta (double &amp;result)
    {
      using namespace Pipes::lnL_eta;

      double loglTotal = 0.;
      double betaminus1 = *Pipes::lnL_eta::Dep::betaminus1_bdparam;
      double gammaminus1 = *Pipes::lnL_eta::Dep::gammaminus1_bdparam;
      double eta_data = -0.6e-4;
      double eta_err = 5.2e-4;
      double eta_model = 4*(betaminus1+1)-(gammaminus1+1)-3;
      double chi2 = pow((eta_model-eta_data)/eta_err,2.0);
      loglTotal += -chi2/2.0;

      // Randomly raise some ficticious alarms about this point, with probability x,
      // where x is given by the input yaml option or a default of 1.
      double x = 1.0-runOptions-&gt;getValueOrDef&lt;double&gt;(1., &quot;probability_of_validity&quot;);
      if (Random::draw() &lt; x)
      {
        invalid_point().raise(&quot;I don't like this point.&quot;);
      }

      // Artificially slow down likelihood evaluations
      // Important for debugging new scanner plugins.
      double eval_time = runOptions-&gt;getValueOrDef&lt;double&gt;(-1, &quot;eval_time&quot;); // Measured in seconds
      //std::cout &lt;&lt; &quot;eval_time:&quot; &lt;&lt; eval_time &lt;&lt;std::endl;
      if(eval_time&gt;0)
      {
         struct timespec sleeptime;
         sleeptime.tv_sec = floor(eval_time);
         sleeptime.tv_nsec = floor((eval_time-floor(eval_time))*1e9); // Allow user to choose fractions of second
         //std::cout &lt;&lt; &quot;Sleeping for &quot;&lt;&lt;sleeptime.tv_sec&lt;&lt;&quot; seconds and &quot;&lt;&lt;sleeptime.tv_nsec&lt;&lt;&quot; nanoseconds&quot; &lt;&lt;std::endl;
         nanosleep(&amp;sleeptime,NULL);
      }

      result = loglTotal;
      logger() &lt;&lt; &quot;Symmetron beta LogLike computed to be: &quot; &lt;&lt; result &lt;&lt; EOM;
    }

    // A likelihood function for comparing the model |gamma-1| to the cassini value
    void lnL_gamma (double &amp;result)
    {
      using namespace Pipes::lnL_gamma;

      double loglTotal = 0.;
      double gammaminus1 = *Pipes::lnL_gamma::Dep::gammaminus1_bdparam;
      double gammaminus1_data = 2.1e-5;
      double gammaminus1_err = 2.3e-5;
      double chi2 = pow((gammaminus1-gammaminus1_data)/gammaminus1_err,2.0);
      loglTotal += -chi2/2.0;

      // Check that the tolerance for phi is reasonable for the data
      double limit = runOptions-&gt;getValueOrDef&lt;double&gt;(1e-5, &quot;gammaminus1_tol&quot;);
      if (0.01*gammaminus1_data &lt; limit) {
        CosmoBit_error().raise(LOCAL_INFO, &quot;Minimum gamma-1 limit for calculating &quot;
        &quot;phi(0) is too large for the given data. Recalculate phi(0) grid with a smaller limit.&quot;);
      }

      // Randomly raise some ficticious alarms about this point, with probability x,
      // where x is given by the input yaml option or a default of 1.
      double x = 1.0-runOptions-&gt;getValueOrDef&lt;double&gt;(1., &quot;probability_of_validity&quot;);
      if (Random::draw() &lt; x)
      {
        invalid_point().raise(&quot;I don't like this point.&quot;);
      }

      // Artificially slow down likelihood evaluations
      // Important for debugging new scanner plugins.
      double eval_time = runOptions-&gt;getValueOrDef&lt;double&gt;(-1, &quot;eval_time&quot;); // Measured in seconds
      //std::cout &lt;&lt; &quot;eval_time:&quot; &lt;&lt; eval_time &lt;&lt;std::endl;
      if(eval_time&gt;0)
      {
         struct timespec sleeptime;
         sleeptime.tv_sec = floor(eval_time);
         sleeptime.tv_nsec = floor((eval_time-floor(eval_time))*1e9); // Allow user to choose fractions of second
         //std::cout &lt;&lt; &quot;Sleeping for &quot;&lt;&lt;sleeptime.tv_sec&lt;&lt;&quot; seconds and &quot;&lt;&lt;sleeptime.tv_nsec&lt;&lt;&quot; nanoseconds&quot; &lt;&lt;std::endl;
         nanosleep(&amp;sleeptime,NULL);
      }

      result = loglTotal;
      logger() &lt;&lt; &quot;Symmetron gamma LogLike computed to be: &quot; &lt;&lt; result &lt;&lt; EOM;
    }

    // A box likelihood function for whether v is allowed by vmin
    void lnL_vmin (double &amp;result)
    {
      using namespace Pipes::lnL_vmin;
      using namespace std;
      const double M_pl = 2.453e18; // [Gev/c^2] reduced planck mass
      double mass, vval;
      // double scale_gravstrength = runOptions-&gt;getValueOrDef&lt;double&gt;(1.0, &quot;gravstrength&quot;);

      if (ModelInUse(&quot;symmetron&quot;))
       {
         double powmass = *Param[&quot;mass&quot;];
         mass = pow(10, powmass)*M_pl;
         double powv = *Param[&quot;vval&quot;];
         vval = pow(10, powv)*M_pl;

         if(Utils::isnan(mass) or Utils::isnan(vval))
         {
           CosmoBit_error().raise(LOCAL_INFO,&quot;NaN detected in input parameters for model&quot;
           &quot; symmetron! This may indicate a bug in the scanner plugin you are using.&quot;);
         }
       } else
       {
          CosmoBit_error().raise(LOCAL_INFO,&quot;Whoops, you are not scanning the model &quot;
           &quot; symmetron! There is probably a bug CosmoBit_rollcall.hpp; this module &quot;
           &quot; function should have ALLOW_MODELS(symmetron) defined.&quot;);
       }

       double logl = 0.0e0;
       if (vval &gt; mass*mass/M_pl){
         logl = 0.0;
       } else {
         logl = -1e30;
       }

       result = logl;
    }

  } // namespace CosmoBit
} // namespace Gambit
*/
</code></pre><hr><p>Updated on 2023-06-26 at 21:36:55 +0000</p></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://gohugo.io/>Hugo</a> and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/license/>License</a></li></ul></div></div></div></footer><script src=/js/bootstrap.min.a08b5ca912a508bc013bbd939befee438a0d2f798076e860e42147c7c0e2a01cf714847f7f5a2824876ce72867b0182df10e3537711faff352dd1ef41550be7c.js integrity="sha512-oItcqRKlCLwBO72Tm+/uQ4oNL3mAduhg5CFHx8DioBz3FIR/f1ooJIds5yhnsBgt8Q41N3Efr/NS3R70FVC+fA==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.ce91dadbce67e8eef36fa222c1c74c99f623c836cf6a316dffa1aeb390ab659d9a20d8145ceac39e049c555414fc360d31315e7980535dc6c03eb5374b7d559d.js integrity="sha512-zpHa285n6O7zb6IiwcdMmfYjyDbPajFt/6Gus5CrZZ2aINgUXOrDngScVVQU/DYNMTFeeYBTXcbAPrU3S31VnQ==" crossorigin=anonymous defer></script>
<script src=/main.min.57d9a84956f7d60008c47938c7fdd2f75e8618ff1d09c5a5e2b32f91debaf7681f7ceca8b51aded60067c2136172134a91ebc0674487c76a04e3244d927ebdde.js integrity="sha512-V9moSVb31gAIxHk4x/3S916GGP8dCcWl4rMvkd6692gffOyotRre1gBnwhNhchNKkevAZ0SHx2oE4yRNkn693g==" crossorigin=anonymous defer></script>
<script src=/index.min.95720397d55302de0e04fb8f4bf89a7396888a3be86803aa187cbc45924e9c35452b4bef718cd568b25ad872307d8f5537eab4c0045b8043c40628674a4fc53d.js integrity="sha512-lXIDl9VTAt4OBPuPS/iac5aIijvoaAOqGHy8RZJOnDVFK0vvcYzVaLJa2HIwfY9VN+q0wARbgEPEBihnSk/FPQ==" crossorigin=anonymous defer></script></body></html>